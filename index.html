<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinTrak | AI-Powered Expense Tracker</title>
    <!-- Load React and Babel -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Load Framer Motion (animations) -->
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script>window.framerMotion = Motion;</script>
    
    <!-- Load Chart.js (data visualization) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    animation: {
                        'bounce-slow': 'bounce 3s infinite',
                        'float': 'float 6s ease-in-out infinite',
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0px)' },
                            '50%': { transform: 'translateY(-10px)' },
                        }
                    },
                    colors: {
                        primary: {
                            DEFAULT: '#00f2c3',
                            light: '#0066cc'
                        },
                        secondary: {
                            DEFAULT: '#0098f0',
                            light: '#004d99'
                        },
                        accent: '#6e00f0',
                        dark: '#0f172a',
                        light: '#f8fafc',
                        glass: 'rgba(255, 255, 255, 0.05)',
                        'glass-border': 'rgba(255, 255, 255, 0.1)',
                        'glass-light': 'rgba(15, 23, 42, 0.05)',
                        'glass-border-light': 'rgba(15, 23, 42, 0.1)'
                    }
                }
            }
        }
    </script>
    
    <!-- Load Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Material+Icons&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #00f2c3;
            --secondary: #0098f0;
            --accent: #6e00f0;
            --dark: #0f172a;
            --light: #f8fafc;
            --glass: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, var(--dark), #1e293b);
            color: var(--light);
            min-height: 100vh;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            transition: background 0.3s ease, color 0.3s ease;
        }
        
        body.light {
            --dark: #f8fafc;
            --light: #0f172a;
            --glass: rgba(15, 23, 42, 0.05);
            --glass-border: rgba(15, 23, 42, 0.1);
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
        }
        
        .glass-card {
            background: var(--glass);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .light .glass-card {
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.05);
        }
        
        .glass-card-hover:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }
        
        .light .glass-card-hover:hover {
            background: rgba(15, 23, 42, 0.1);
            border-color: rgba(15, 23, 42, 0.2);
        }
        
        .gradient-text {
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .ripple {
            position: relative;
            overflow: hidden;
        }
        
        .ripple:after {
            content: "";
            display: block;
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            background-image: radial-gradient(circle, #fff 10%, transparent 10.01%);
            background-repeat: no-repeat;
            background-position: 50%;
            transform: scale(10, 10);
            opacity: 0;
            transition: transform .5s, opacity 1s;
        }
        
        .ripple:active:after {
            transform: scale(0, 0);
            opacity: 0.3;
            transition: 0s;
        }
        
        .blur-bg {
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        
        .floating {
            animation: float 6s ease-in-out infinite;
        }
        
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        .typing-animation {
            overflow: hidden;
            border-right: 2px solid var(--primary);
            white-space: nowrap;
            animation: typing 3.5s steps(40, end), blink-caret .75s step-end infinite;
        }
        
        @keyframes typing {
            from { width: 0 }
            to { width: 100% }
        }
        
        @keyframes blink-caret {
            from, to { border-color: transparent }
            50% { border-color: var(--primary) }
        }
        
        .pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .material-icons {
            font-family: 'Material Icons';
            font-weight: normal;
            font-style: normal;
            font-size: 24px;
            line-height: 1;
            letter-spacing: normal;
            text-transform: none;
            display: inline-block;
            white-space: nowrap;
            word-wrap: normal;
            direction: ltr;
            -webkit-font-feature-settings: 'liga';
            -webkit-font-smoothing: antialiased;
        }
        
        .elevation-1 {
            box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
        }
        
        .elevation-2 {
            box-shadow: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);
        }
        
        .elevation-3 {
            box-shadow: 0 10px 20px rgba(0,0,0,0.19), 0 6px 6px rgba(0,0,0,0.23);
        }
        
        .elevation-4 {
            box-shadow: 0 14px 28px rgba(0,0,0,0.25), 0 10px 10px rgba(0,0,0,0.22);
        }
        
        .elevation-5 {
            box-shadow: 0 19px 38px rgba(0,0,0,0.30), 0 15px 12px rgba(0,0,0,0.22);
        }
        
        .wave {
            position: relative;
            overflow: hidden;
        }
        
        .wave:after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
            transform: scale(0);
            opacity: 0;
            pointer-events: none;
            transition: transform 0.6s, opacity 0.6s;
        }
        
        .wave:hover:after {
            transform: scale(2);
            opacity: 1;
        }
        
        .slide-in {
            animation: slideIn 0.3s ease-out forwards;
        }
        
        @keyframes slideIn {
            from {
                transform: translateY(20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in forwards;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .rotate {
            animation: rotate 2s linear infinite;
        }
        
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .gradient-border {
            position: relative;
            border-radius: 16px;
        }
        
        .gradient-border:before {
            content: "";
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, var(--primary), var(--secondary), var(--accent));
            border-radius: 18px;
            z-index: -1;
            opacity: 0.7;
            transition: opacity 0.3s;
        }
        
        .gradient-border:hover:before {
            opacity: 1;
        }
        
        /* Light mode specific styles */
        .light input,
        .light select,
        .light textarea {
            background: rgba(255, 255, 255, 0.8);
            color: var(--light) !important;
            border-color: rgba(15, 23, 42, 0.1);
        }
        
        .light input::placeholder,
        .light textarea::placeholder {
            color: rgba(15, 23, 42, 0.5);
        }
        
        .light .text-white {
            color: var(--light) !important;
        }
        
        .light .text-white\\/70 {
            color: rgba(15, 23, 42, 0.7) !important;
        }
        
        .light .text-white\\/50 {
            color: rgba(15, 23, 42, 0.5);
        }
        
        /* Accessibility improvements */
        button:focus,
        input:focus,
        select:focus,
        a:focus {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }
        
        /* Responsive improvements */
        @media (max-width: 768px) {
            .mobile-column {
                flex-direction: column;
            }
            
            .mobile-full-width {
                width: 100%;
            }
            
            .mobile-mt-2 {
                margin-top: 0.5rem;
            }
        }
        
        /* Loading skeleton */
        .skeleton {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 0.25rem;
        }
        
        .light .skeleton {
            background-color: rgba(15, 23, 42, 0.1);
        }
    </style>
</head>
<body class="dark">
    <div id="root"></div>

    <script type="text/babel">
        // Main App Component
        const { useState, useEffect, useRef, createContext, useContext, useMemo, useReducer } = React;
        const { motion, AnimatePresence } = framerMotion;
        
        // Create Contexts
        const AppStateContext = createContext();
        const AppActionsContext = createContext();
        
        // Initial state
        const initialState = {
            user: null,
            authToken: null,
            transactions: [],
            investments: [],
            budgets: [],
            goals: [],
            insights: [],
            notifications: [],
            activeTab: "dashboard",
            isAddExpenseOpen: false,
            isAddInvestmentOpen: false,
            isAddBudgetOpen: false,
            isAddGoalOpen: false,
            isSettingsOpen: false,
            isLoginOpen: true,
            isRegisterOpen: false,
            isLoading: true,
            theme: 'dark'
        };
        
        // Reducer function
        function appReducer(state, action) {
            switch (action.type) {
                case 'SET_USER':
                    return { ...state, user: action.payload };
                case 'SET_AUTH_TOKEN':
                    return { ...state, authToken: action.payload };
                case 'SET_TRANSACTIONS':
                    return { ...state, transactions: action.payload };
                case 'SET_INVESTMENTS':
                    return { ...state, investments: action.payload };
                case 'SET_BUDGETS':
                    return { ...state, budgets: action.payload };
                case 'SET_GOALS':
                    return { ...state, goals: action.payload };
                case 'SET_INSIGHTS':
                    return { ...state, insights: action.payload };
                case 'ADD_NOTIFICATION':
                    return { ...state, notifications: [...state.notifications, action.payload] };
                case 'REMOVE_NOTIFICATION':
                    return { ...state, notifications: state.notifications.filter(n => n.id !== action.payload) };
                case 'SET_ACTIVE_TAB':
                    return { ...state, activeTab: action.payload };
                case 'TOGGLE_MODAL':
                    return { ...state, [action.payload]: !state[action.payload] };
                case 'SET_THEME':
                    return { ...state, theme: action.payload };
                case 'SET_LOADING':
                    return { ...state, isLoading: action.payload };
                default:
                    return state;
            }
        }
        
        // App Provider Component
        function AppProvider({ children }) {
            const [state, dispatch] = useReducer(appReducer, initialState);
            
            // Memoized actions
            const actions = useMemo(() => ({
                login: async (email, password) => {
                    return new Promise((resolve) => {
                        setTimeout(() => {
                            const user = {
                                id: 'user123',
                                name: "Divyajeet Panda",
                                email: email,
                                currency: "USD",
                                avatar: `https://i.pravatar.cc/150?u=${email}`
                            };
                            
                            dispatch({ type: 'SET_USER', payload: user });
                            dispatch({ type: 'SET_AUTH_TOKEN', payload: 'fake-auth-token' });
                            dispatch({ type: 'TOGGLE_MODAL', payload: 'isLoginOpen' });
                            dispatch({ type: 'SET_LOADING', payload: false });
                            
                            loadUserData();
                            resolve(user);
                        }, 1000);
                    });
                },
                
                register: async (name, email, password) => {
                    return new Promise((resolve) => {
                        setTimeout(() => {
                            const user = {
                                id: 'newuser' + Date.now(),
                                name: name,
                                email: email,
                                currency: "USD",
                                avatar: `https://i.pravatar.cc/150?u=${email}`
                            };
                            
                            dispatch({ type: 'SET_USER', payload: user });
                            dispatch({ type: 'SET_AUTH_TOKEN', payload: 'fake-auth-token' });
                            dispatch({ type: 'TOGGLE_MODAL', payload: 'isRegisterOpen' });
                            dispatch({ type: 'SET_LOADING', payload: false });
                            
                            initializeNewUserData();
                            resolve(user);
                        }, 1000);
                    });
                },
                
                logout: () => {
                    dispatch({ type: 'SET_USER', payload: null });
                    dispatch({ type: 'SET_AUTH_TOKEN', payload: null });
                    dispatch({ type: 'SET_TRANSACTIONS', payload: [] });
                    dispatch({ type: 'SET_INVESTMENTS', payload: [] });
                    dispatch({ type: 'SET_BUDGETS', payload: [] });
                    dispatch({ type: 'SET_GOALS', payload: [] });
                    dispatch({ type: 'TOGGLE_MODAL', payload: 'isLoginOpen' });
                    localStorage.removeItem('neonFinanceToken');
                },
                
                setActiveTab: (tab) => dispatch({ type: 'SET_ACTIVE_TAB', payload: tab }),
                
                toggleAddExpense: () => dispatch({ type: 'TOGGLE_MODAL', payload: 'isAddExpenseOpen' }),
                toggleAddInvestment: () => dispatch({ type: 'TOGGLE_MODAL', payload: 'isAddInvestmentOpen' }),
                toggleAddBudget: () => dispatch({ type: 'TOGGLE_MODAL', payload: 'isAddBudgetOpen' }),
                toggleAddGoal: () => dispatch({ type: 'TOGGLE_MODAL', payload: 'isAddGoalOpen' }),
                toggleSettings: () => dispatch({ type: 'TOGGLE_MODAL', payload: 'isSettingsOpen' }),
                toggleLogin: () => dispatch({ type: 'TOGGLE_MODAL', payload: 'isLoginOpen' }),
                toggleRegister: () => dispatch({ type: 'TOGGLE_MODAL', payload: 'isRegisterOpen' }),
                
                addTransaction: (transaction) => {
                    const newTransactions = [...state.transactions, transaction];
                    dispatch({ type: 'SET_TRANSACTIONS', payload: newTransactions });
                    
                    // Update insights
                    const newInsights = generateInsights(
                        newTransactions,
                        state.investments,
                        state.budgets,
                        state.goals
                    );
                    dispatch({ type: 'SET_INSIGHTS', payload: newInsights });
                    
                    // Update budget if this is an expense
                    if (transaction.amount < 0) {
                        actions.updateBudgetSpending(transaction.category, Math.abs(transaction.amount));
                    }
                },
                
                addInvestment: (investment) => {
                    const newInvestments = [...state.investments, investment];
                    dispatch({ type: 'SET_INVESTMENTS', payload: newInvestments });
                    
                    // Update insights
                    const newInsights = generateInsights(
                        state.transactions,
                        newInvestments,
                        state.budgets,
                        state.goals
                    );
                    dispatch({ type: 'SET_INSIGHTS', payload: newInsights });
                },
                
                addBudget: (budget) => {
                    const newBudgets = [...state.budgets, budget];
                    dispatch({ type: 'SET_BUDGETS', payload: newBudgets });
                    
                    // Update insights
                    const newInsights = generateInsights(
                        state.transactions,
                        state.investments,
                        newBudgets,
                        state.goals
                    );
                    dispatch({ type: 'SET_INSIGHTS', payload: newInsights });
                },
                
                addGoal: (goal) => {
                    const newGoals = [...state.goals, goal];
                    dispatch({ type: 'SET_GOALS', payload: newGoals });
                    
                    // Update insights
                    const newInsights = generateInsights(
                        state.transactions,
                        state.investments,
                        state.budgets,
                        newGoals
                    );
                    dispatch({ type: 'SET_INSIGHTS', payload: newInsights });
                },
                
                updateBudgetSpending: (category, amount) => {
                    const updatedBudgets = state.budgets.map(budget => {
                        if (budget.category === category) {
                            return { ...budget, spent: (budget.spent || 0) + amount };
                        }
                        return budget;
                    });
                    
                    dispatch({ type: 'SET_BUDGETS', payload: updatedBudgets });
                    
                    // Update insights
                    const newInsights = generateInsights(
                        state.transactions,
                        state.investments,
                        updatedBudgets,
                        state.goals
                    );
                    dispatch({ type: 'SET_INSIGHTS', payload: newInsights });
                },
                
                addToGoal: (goalId, amount) => {
                    const updatedGoals = state.goals.map(goal => {
                        if (goal.id === goalId) {
                            return { ...goal, saved: (goal.saved || 0) + amount };
                        }
                        return goal;
                    });
                    
                    dispatch({ type: 'SET_GOALS', payload: updatedGoals });
                    
                    // Update insights
                    const newInsights = generateInsights(
                        state.transactions,
                        state.investments,
                        state.budgets,
                        updatedGoals
                    );
                    dispatch({ type: 'SET_INSIGHTS', payload: newInsights });
                },
                
                deleteTransaction: (id) => {
                    const transactionToDelete = state.transactions.find(t => t.id === id);
                    const newTransactions = state.transactions.filter(t => t.id !== id);
                    
                    dispatch({ type: 'SET_TRANSACTIONS', payload: newTransactions });
                    
                    // Update budget if this was an expense
                    if (transactionToDelete && transactionToDelete.amount < 0) {
                        const updatedBudgets = state.budgets.map(budget => {
                            if (budget.category === transactionToDelete.category) {
                                return { ...budget, spent: (budget.spent || 0) - Math.abs(transactionToDelete.amount) };
                            }
                            return budget;
                        });
                        
                        dispatch({ type: 'SET_BUDGETS', payload: updatedBudgets });
                        
                        // Update insights
                        const newInsights = generateInsights(
                            newTransactions,
                            state.investments,
                            updatedBudgets,
                            state.goals
                        );
                        dispatch({ type: 'SET_INSIGHTS', payload: newInsights });
                    } else {
                        // Update insights without budget change
                        const newInsights = generateInsights(
                            newTransactions,
                            state.investments,
                            state.budgets,
                            state.goals
                        );
                        dispatch({ type: 'SET_INSIGHTS', payload: newInsights });
                    }
                },
                
                deleteInvestment: (id) => {
                    const newInvestments = state.investments.filter(i => i.id !== id);
                    dispatch({ type: 'SET_INVESTMENTS', payload: newInvestments });
                    
                    // Update insights
                    const newInsights = generateInsights(
                        state.transactions,
                        newInvestments,
                        state.budgets,
                        state.goals
                    );
                    dispatch({ type: 'SET_INSIGHTS', payload: newInsights });
                },
                
                deleteBudget: (id) => {
                    const newBudgets = state.budgets.filter(b => b.id !== id);
                    dispatch({ type: 'SET_BUDGETS', payload: newBudgets });
                    
                    // Update insights
                    const newInsights = generateInsights(
                        state.transactions,
                        state.investments,
                        newBudgets,
                        state.goals
                    );
                    dispatch({ type: 'SET_INSIGHTS', payload: newInsights });
                },
                
                deleteGoal: (id) => {
                    const newGoals = state.goals.filter(g => g.id !== id);
                    dispatch({ type: 'SET_GOALS', payload: newGoals });
                    
                    // Update insights
                    const newInsights = generateInsights(
                        state.transactions,
                        state.investments,
                        state.budgets,
                        newGoals
                    );
                    dispatch({ type: 'SET_INSIGHTS', payload: newInsights });
                },
                
                updateUser: (user) => {
                    dispatch({ type: 'SET_USER', payload: user });
                },
                
                addNotification: (notification) => {
                    dispatch({ type: 'ADD_NOTIFICATION', payload: notification });
                    
                    // Auto-remove notification after 5 seconds
                    setTimeout(() => {
                        dispatch({ type: 'REMOVE_NOTIFICATION', payload: notification.id });
                    }, 5000);
                },
                
                toggleTheme: () => {
                    const newTheme = state.theme === 'dark' ? 'light' : 'dark';
                    dispatch({ type: 'SET_THEME', payload: newTheme });
                    document.body.classList.toggle('light', newTheme === 'light');
                    document.body.classList.toggle('dark', newTheme === 'dark');
                    localStorage.setItem('neonFinanceTheme', newTheme);
                }
            }), [state.transactions, state.investments, state.budgets, state.goals, state.theme]);
            
            // Initialize new user data
            const initializeNewUserData = () => {
                const initialTransactions = [
                    { id: '1', amount: -45.99, category: 'food', date: new Date().toISOString().split('T')[0], description: 'Dinner at Italian Place' },
                    { id: '2', amount: -12.50, category: 'transport', date: new Date().toISOString().split('T')[0], description: 'Taxi ride' },
                    { id: '3', amount: 2500.00, category: 'income', date: new Date().toISOString().split('T')[0], description: 'Salary' },
                ];
                
                const initialBudgets = [
                    { id: '1', category: 'food', amount: 500, spent: 45.99 },
                    { id: '2', category: 'transport', amount: 200, spent: 12.50 },
                    { id: '3', category: 'entertainment', amount: 150, spent: 0 },
                ];
                
                const initialGoals = [
                    { id: '1', name: 'Emergency Fund', target: 5000, saved: 1200, deadline: '2023-12-31' },
                    { id: '2', name: 'New Laptop', target: 1500, saved: 300, deadline: '2023-09-30' },
                ];
                
                dispatch({ type: 'SET_TRANSACTIONS', payload: initialTransactions });
                dispatch({ type: 'SET_BUDGETS', payload: initialBudgets });
                dispatch({ type: 'SET_GOALS', payload: initialGoals });
                dispatch({ type: 'SET_INSIGHTS', payload: generateInsights(initialTransactions, [], initialBudgets, initialGoals) });
            };
            
            // Load user data
            const loadUserData = () => {
                const storedData = localStorage.getItem('neonFinanceData');
                if (storedData) {
                    const data = JSON.parse(storedData);
                    dispatch({ type: 'SET_TRANSACTIONS', payload: data.transactions || [] });
                    dispatch({ type: 'SET_INVESTMENTS', payload: data.investments || [] });
                    dispatch({ type: 'SET_BUDGETS', payload: data.budgets || [] });
                    dispatch({ type: 'SET_GOALS', payload: data.goals || [] });
                    dispatch({ type: 'SET_INSIGHTS', payload: generateInsights(
                        data.transactions || [], 
                        data.investments || [],
                        data.budgets || [],
                        data.goals || []
                    ) });
                } else {
                    // Sample initial data
                    const initialTransactions = [
                        { id: '1', amount: -45.99, category: 'food', date: '2023-06-01', description: 'Dinner at Italian Place' },
                        { id: '2', amount: -12.50, category: 'transport', date: '2023-06-02', description: 'Taxi ride' },
                        { id: '3', amount: -120.00, category: 'shopping', date: '2023-06-03', description: 'New shoes' },
                        { id: '4', amount: 2500.00, category: 'income', date: '2023-06-01', description: 'Salary' },
                        { id: '5', amount: -9.99, category: 'entertainment', date: '2023-06-04', description: 'Netflix subscription' },
                    ];
                    
                    const initialInvestments = [
                        { id: '1', name: 'Tech Stocks', amount: 5000, type: 'stocks', date: '2023-01-15', roi: 12.5 },
                        { id: '2', name: 'Crypto Portfolio', amount: 2500, type: 'crypto', date: '2023-03-20', roi: -5.3 },
                        { id: '3', name: 'Retirement Fund', amount: 15000, type: 'mutual', date: '2022-11-05', roi: 7.2 },
                    ];
                    
                    const initialBudgets = [
                        { id: '1', category: 'food', amount: 500, spent: 178.99 },
                        { id: '2', category: 'transport', amount: 200, spent: 85.50 },
                        { id: '3', category: 'entertainment', amount: 150, spent: 49.99 },
                    ];
                    
                    const initialGoals = [
                        { id: '1', name: 'Emergency Fund', target: 10000, saved: 4500, deadline: '2023-12-31' },
                        { id: '2', name: 'Vacation', target: 3000, saved: 1200, deadline: '2023-08-15' },
                    ];
                    
                    dispatch({ type: 'SET_TRANSACTIONS', payload: initialTransactions });
                    dispatch({ type: 'SET_INVESTMENTS', payload: initialInvestments });
                    dispatch({ type: 'SET_BUDGETS', payload: initialBudgets });
                    dispatch({ type: 'SET_GOALS', payload: initialGoals });
                    dispatch({ type: 'SET_INSIGHTS', payload: generateInsights(initialTransactions, initialInvestments, initialBudgets, initialGoals) });
                }
            };
            
            // Save data to localStorage when state changes
            useEffect(() => {
                if (state.user) {
                    localStorage.setItem('neonFinanceData', JSON.stringify({
                        transactions: state.transactions,
                        investments: state.investments,
                        budgets: state.budgets,
                        goals: state.goals
                    }));
                }
            }, [state.transactions, state.investments, state.budgets, state.goals, state.user]);
            
            // Check for existing session on load
            useEffect(() => {
                // Set initial theme
                const savedTheme = localStorage.getItem('neonFinanceTheme') || 'dark';
                dispatch({ type: 'SET_THEME', payload: savedTheme });
                document.body.classList.toggle('light', savedTheme === 'light');
                document.body.classList.toggle('dark', savedTheme === 'dark');
                
                const token = localStorage.getItem('neonFinanceToken');
                if (token) {
                    // Simulate token validation
                    setTimeout(() => {
                        dispatch({ type: 'SET_USER', payload: {
                            id: 'user123',
                            name: "Alex Johnson",
                            email: "alex@example.com",
                            currency: "USD",
                            avatar: "https://i.pravatar.cc/150?u=alex@example.com"
                        }});
                        dispatch({ type: 'SET_AUTH_TOKEN', payload: token });
                        dispatch({ type: 'SET_LOADING', payload: false });
                        loadUserData();
                    }, 1000);
                } else {
                    dispatch({ type: 'SET_LOADING', payload: false });
                }
            }, []);
            
            return (
                <AppStateContext.Provider value={state}>
                    <AppActionsContext.Provider value={actions}>
                        {children}
                    </AppActionsContext.Provider>
                </AppStateContext.Provider>
            );
        }
        
        // Custom hooks to use the context
        function useAppState() {
            return useContext(AppStateContext);
        }
        
        function useAppActions() {
            return useContext(AppActionsContext);
        }
        
        // AI Insight Generation
        function generateInsights(transactions, investments, budgets, goals) {
            const insights = [];
            
            // Calculate total expenses and income
            const totalExpenses = transactions
                .filter(t => t.amount < 0)
                .reduce((sum, t) => sum + Math.abs(t.amount), 0);
            
            const totalIncome = transactions
                .filter(t => t.amount > 0)
                .reduce((sum, t) => sum + t.amount, 0);
            
            // Savings rate
            const savingsRate = totalIncome > 0 ? ((totalIncome - totalExpenses) / totalIncome) * 100 : 0;
            
            if (totalIncome > 0) {
                if (savingsRate < 20) {
                    insights.push({
                        id: 'savings-low-' + Date.now(),
                        type: 'warning',
                        message: `Your savings rate is low (${savingsRate.toFixed(1)}%). Try to save at least 20% of your income.`,
                        action: 'Review your expenses in the Expenses tab.',
                        icon: 'savings'
                    });
                } else if (savingsRate > 30) {
                    insights.push({
                        id: 'savings-high-' + Date.now(),
                        type: 'success',
                        message: `Great job! Your savings rate is ${savingsRate.toFixed(1)}%.`,
                        action: 'Consider investing your extra savings.',
                        icon: 'celebration'
                    });
                }
            }
            
            // Category analysis
            const categories = {};
            transactions
                .filter(t => t.amount < 0)
                .forEach(t => {
                    categories[t.category] = (categories[t.category] || 0) + Math.abs(t.amount);
                });
            
            const topCategory = Object.entries(categories).sort((a, b) => b[1] - a[1])[0];
            if (topCategory) {
                insights.push({
                    id: 'top-category-' + Date.now(),
                    type: 'info',
                    message: `Your biggest spending category is ${topCategory[0]} (${formatCurrency(topCategory[1])}).`,
                    action: 'Consider setting a budget for this category.',
                    icon: 'category'
                });
            }
            
            // Budget insights
            budgets.forEach(budget => {
                const spentPercentage = (budget.spent / budget.amount) * 100;
                
                if (spentPercentage > 90) {
                    insights.push({
                        id: `budget-${budget.category}-${Date.now()}`,
                        type: 'warning',
                        message: `You've spent ${spentPercentage.toFixed(0)}% of your ${budget.category} budget.`,
                        action: 'Consider reducing spending in this category.',
                        icon: 'warning'
                    });
                }
            });
            
            // Goal insights
            goals.forEach(goal => {
                const progressPercentage = (goal.saved / goal.target) * 100;
                const daysRemaining = Math.ceil((new Date(goal.deadline) - new Date()) / (1000 * 60 * 60 * 24));
                
                if (daysRemaining > 0) {
                    const dailySavingsNeeded = (goal.target - goal.saved) / daysRemaining;
                    
                    if (dailySavingsNeeded > 10) {
                        insights.push({
                            id: `goal-${goal.id}-${Date.now()}`,
                            type: 'info',
                            message: `To reach your ${goal.name} goal, you need to save ${formatCurrency(dailySavingsNeeded)} daily.`,
                            action: 'Adjust your savings or deadline to make it more achievable.',
                            icon: 'savings'
                        });
                    }
                }
            });
            
            // Investment insights
            const totalInvested = investments.reduce((sum, i) => sum + i.amount, 0);
            const avgRoi = investments.length > 0 
                ? investments.reduce((sum, i) => sum + i.roi, 0) / investments.length
                : 0;
            
            if (totalInvested > 0) {
                insights.push({
                    id: 'investments-' + Date.now(),
                    type: 'success',
                    message: `Your investments are averaging ${avgRoi.toFixed(1)}% return.`,
                    action: 'Consider diversifying your portfolio.',
                    icon: 'trending_up'
                });
            }
            
            // Weekly spending pattern
            const today = new Date();
            const lastWeek = new Date(today);
            lastWeek.setDate(lastWeek.getDate() - 7);
            
            const lastWeekSpending = transactions
                .filter(t => new Date(t.date) >= lastWeek && t.amount < 0)
                .reduce((sum, t) => sum + Math.abs(t.amount), 0);
            
            insights.push({
                id: 'weekly-spending-' + Date.now(),
                type: 'info',
                message: `You've spent ${formatCurrency(lastWeekSpending)} in the last 7 days.`,
                action: 'Track your daily spending to stay on budget.',
                icon: 'calendar_today'
            });
            
            // Recurring expenses detection
            const recurringExpenses = {};
            transactions
                .filter(t => t.amount < 0)
                .forEach(t => {
                    const key = `${t.description.toLowerCase()}-${Math.abs(t.amount).toFixed(2)}`;
                    recurringExpenses[key] = (recurringExpenses[key] || 0) + 1;
                });
            
            const potentialRecurring = Object.entries(recurringExpenses)
                .filter(([_, count]) => count >= 3)
                .map(([key]) => key.split('-')[0]);
            
            if (potentialRecurring.length > 0) {
                insights.push({
                    id: 'recurring-' + Date.now(),
                    type: 'info',
                    message: `You have recurring expenses for: ${potentialRecurring.join(', ')}.`,
                    action: 'Consider setting up a budget for these regular expenses.',
                    icon: 'autorenew'
                });
            }
            
            return insights;
        }
        
        // Format currency
        function formatCurrency(amount, currency = 'USD') {
			const options = {
				style: 'currency',
				currency: currency,
				minimumFractionDigits: 2,
				maximumFractionDigits: 2
			};
		
		  // Special case for INR which doesn't use cents
		  if (currency === 'INR') {
			options.minimumFractionDigits = 0;
			options.maximumFractionDigits = 0;
		  }
		  
		    return new Intl.NumberFormat(getLocaleForCurrency(currency), options).format(amount);
		}
		
		function getLocaleForCurrency(currency) {
		  const locales = {
			USD: 'en-US',
			EUR: 'de-DE',
			GBP: 'en-GB',
			JPY: 'ja-JP',
			INR: 'en-IN'
		  };
		  return locales[currency] || 'en-US';
		}
        
        // Format date
        function formatDate(dateString) {
            const options = { year: 'numeric', month: 'short', day: 'numeric' };
            return new Date(dateString).toLocaleDateString(undefined, options);
        }
        
        // Categories with icons and colors
        const categories = {
            food: { name: 'Food & Dining', icon: 'restaurant', color: 'bg-red-400' },
            transport: { name: 'Transport', icon: 'directions_car', color: 'bg-blue-400' },
            shopping: { name: 'Shopping', icon: 'shopping_bag', color: 'bg-purple-400' },
            entertainment: { name: 'Entertainment', icon: 'movie', color: 'bg-yellow-400' },
            housing: { name: 'Housing', icon: 'home', color: 'bg-green-400' },
            utilities: { name: 'Utilities', icon: 'bolt', color: 'bg-orange-400' },
            healthcare: { name: 'Healthcare', icon: 'medical_services', color: 'bg-pink-400' },
            education: { name: 'Education', icon: 'school', color: 'bg-indigo-400' },
            income: { name: 'Income', icon: 'attach_money', color: 'bg-emerald-400' },
            other: { name: 'Other', icon: 'category', color: 'bg-gray-400' },
        };
        
        // Investment types
        const investmentTypes = {
            stocks: { name: 'Stocks', icon: 'trending_up', color: 'bg-blue-500' },
            crypto: { name: 'Crypto', icon: 'currency_bitcoin', color: 'bg-yellow-500' },
            mutual: { name: 'Mutual Funds', icon: 'account_balance', color: 'bg-green-500' },
            bonds: { name: 'Bonds', icon: 'show_chart', color: 'bg-purple-500' },
            real_estate: { name: 'Real Estate', icon: 'apartment', color: 'bg-red-500' },
        };
        
        // Main App
        function App() {
            const { user, isLoading } = useAppState();
            
            if (isLoading) {
                return (
                    <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-dark to-gray-900">
                        <motion.div
                            animate={{ rotate: 360 }}
                            transition={{ duration: 2, repeat: Infinity, ease: "linear" }}
                            className="w-16 h-16 rounded-full border-4 border-primary border-t-transparent"
                        />
                    </div>
                );
            }
            
            if (!user) {
                return <AuthScreen />;
            }
            
            return (
                <div className="min-h-screen flex flex-col">
                    <Header />
                    <div className="flex flex-1 overflow-hidden">
                        <Sidebar />
                        <MainContent />
                    </div>
                    <MobileNav />
                    <AddExpenseModal />
                    <AddInvestmentModal />
                    <AddBudgetModal />
                    <AddGoalModal />
                    <SettingsModal />
                    <Notifications />
                </div>
            );
        }
        
        // Auth Screen Component
        function AuthScreen() {
            const { isLoginOpen, isRegisterOpen } = useAppState();
            const { toggleLogin, toggleRegister, login, register } = useAppActions();
            
            return (
                <div className="min-h-screen flex items-center justify-center p-4">
                    <AnimatePresence mode="wait">
                        {isLoginOpen && (
                            <motion.div
                                key="login"
                                initial={{ opacity: 0, scale: 0.9 }}
                                animate={{ opacity: 1, scale: 1 }}
                                exit={{ opacity: 0, scale: 0.9 }}
                                transition={{ duration: 0.3 }}
                                className="glass-card p-8 rounded-2xl w-full max-w-md"
                            >
                                <div className="text-center mb-8">
                                    <motion.div
                                        initial={{ y: -20, opacity: 0 }}
                                        animate={{ y: 0, opacity: 1 }}
                                        transition={{ delay: 0.2 }}
                                        className="w-20 h-20 rounded-full bg-gradient-to-r from-primary to-secondary flex items-center justify-center mx-auto mb-4"
                                    >
                                        <span className="material-icons text-4xl text-white">account_balance</span>
                                    </motion.div>
                                    <h1 className="text-3xl font-bold gradient-text mb-2">Fintrak</h1>
                                    <p className="text-white/70">AI-powered personal finance tracker</p>
                                </div>
                                
                                <LoginForm 
                                    onLogin={login} 
                                    onSwitchToRegister={() => {
                                        toggleLogin();
                                        toggleRegister();
                                    }} 
                                />
                            </motion.div>
                        )}
                        
                        {isRegisterOpen && (
                            <motion.div
                                key="register"
                                initial={{ opacity: 0, scale: 0.9 }}
                                animate={{ opacity: 1, scale: 1 }}
                                exit={{ opacity: 0, scale: 0.9 }}
                                transition={{ duration: 0.3 }}
                                className="glass-card p-8 rounded-2xl w-full max-w-md"
                            >
                                <div className="text-center mb-8">
                                    <motion.div
                                        initial={{ y: -20, opacity: 0 }}
                                        animate={{ y: 0, opacity: 1 }}
                                        transition={{ delay: 0.2 }}
                                        className="w-20 h-20 rounded-full bg-gradient-to-r from-primary to-secondary flex items-center justify-center mx-auto mb-4"
                                    >
                                        <span className="material-icons text-4xl text-white">account_balance</span>
                                    </motion.div>
                                    <h1 className="text-3xl font-bold gradient-text mb-2">Create Account</h1>
                                    <p className="text-white/70">Start managing your finances today</p>
                                </div>
                                
                                <RegisterForm 
                                    onRegister={register} 
                                    onSwitchToLogin={() => {
                                        toggleRegister();
                                        toggleLogin();
                                    }} 
                                />
                            </motion.div>
                        )}
                    </AnimatePresence>
                    
                    <motion.div 
                        initial={{ opacity: 0 }}
                        animate={{ opacity: 1 }}
                        transition={{ delay: 0.5 }}
                        className="absolute bottom-4 left-0 right-0 text-center text-white/50 text-sm"
                    >
                        © {new Date().getFullYear()} Fintrak. All rights reserved.
                    </motion.div>
                </div>
            );
        }
        
        // Login Form Component
        function LoginForm({ onLogin, onSwitchToRegister }) {
            const [email, setEmail] = useState('');
            const [password, setPassword] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [error, setError] = useState('');
            
            const handleSubmit = async (e) => {
                e.preventDefault();
                setIsLoading(true);
                setError('');
                
                try {
                    await onLogin(email, password);
                } catch (err) {
                    setError('Invalid email or password. Please try again.');
                } finally {
                    setIsLoading(false);
                }
            };
            
            return (
                <form onSubmit={handleSubmit} className="space-y-4">
                    {error && (
                        <motion.div 
                            initial={{ opacity: 0, y: -10 }}
                            animate={{ opacity: 1, y: 0 }}
                            className="p-3 bg-red-500/20 rounded-lg text-red-300 flex items-center"
                        >
                            <span className="material-icons mr-2">error</span>
                            {error}
                        </motion.div>
                    )}
                    
                    <div>
                        <label className="block text-sm text-white/70 mb-1">Email</label>
                        <div className="relative">
                            <span className="material-icons absolute left-3 top-1/2 transform -translate-y-1/2 text-white/50">email</span>
                            <input
                                type="email"
                                className="w-full glass-card pl-10 p-3 rounded-lg border border-white/10 focus:outline-none focus:ring-2 focus:ring-primary/50"
                                value={email}
                                onChange={(e) => setEmail(e.target.value)}
                                required
                            />
                        </div>
                    </div>
                    
                    <div>
                        <label className="block text-sm text-white/70 mb-1">Password</label>
                        <div className="relative">
                            <span className="material-icons absolute left-3 top-1/2 transform -translate-y-1/2 text-white/50">lock</span>
                            <input
                                type="password"
                                className="w-full glass-card pl-10 p-3 rounded-lg border border-white/10 focus:outline-none focus:ring-2 focus:ring-primary/50"
                                value={password}
                                onChange={(e) => setPassword(e.target.value)}
                                required
                            />
                        </div>
                    </div>
                    
                    <div className="pt-2">
                        <motion.button
                            whileHover={{ scale: 1.02 }}
                            whileTap={{ scale: 0.98 }}
                            className="ripple w-full py-3 rounded-lg bg-gradient-to-r from-primary to-secondary text-white flex items-center justify-center"
                            type="submit"
                            disabled={isLoading}
                        >
                            {isLoading ? (
                                <motion.span
                                    animate={{ rotate: 360 }}
                                    transition={{ duration: 1, repeat: Infinity, ease: "linear" }}
                                    className="w-5 h-5 border-2 border-white border-t-transparent rounded-full"
                                />
                            ) : (
                                'Login'
                            )}
                        </motion.button>
                    </div>
                    
                    <div className="text-center text-sm text-white/70">
                        Don't have an account?{' '}
                        <button 
                            type="button" 
                            className="text-primary hover:underline focus:outline-none"
                            onClick={onSwitchToRegister}
                        >
                            Sign up
                        </button>
                    </div>
                    
                    <div className="flex items-center my-4">
                        <div className="flex-1 h-px bg-white/10"></div>
                        <span className="px-3 text-white/50 text-sm">OR</span>
                        <div className="flex-1 h-px bg-white/10"></div>
                    </div>
                    
                    <motion.button
                        whileHover={{ scale: 1.02 }}
                        whileTap={{ scale: 0.98 }}
                        className="ripple w-full py-3 rounded-lg bg-white/5 text-white flex items-center justify-center"
                        type="button"
                    >
                        <span className="material-icons mr-2">google</span>
                        Continue with Google
                    </motion.button>
                </form>
            );
        }
        
        // Register Form Component
        function RegisterForm({ onRegister, onSwitchToLogin }) {
            const [name, setName] = useState('');
            const [email, setEmail] = useState('');
            const [password, setPassword] = useState('');
            const [confirmPassword, setConfirmPassword] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [error, setError] = useState('');
            
            const handleSubmit = async (e) => {
                e.preventDefault();
                
                if (password !== confirmPassword) {
                    setError('Passwords do not match');
                    return;
                }
                
                setIsLoading(true);
                setError('');
                
                try {
                    await onRegister(name, email, password);
                } catch (err) {
                    setError('Registration failed. Please try again.');
                } finally {
                    setIsLoading(false);
                }
            };
            
            return (
                <form onSubmit={handleSubmit} className="space-y-4">
                    {error && (
                        <motion.div 
                            initial={{ opacity: 0, y: -10 }}
                            animate={{ opacity: 1, y: 0 }}
                            className="p-3 bg-red-500/20 rounded-lg text-red-300 flex items-center"
                        >
                            <span className="material-icons mr-2">error</span>
                            {error}
                        </motion.div>
                    )}
                    
                    <div>
                        <label className="block text-sm text-white/70 mb-1">Full Name</label>
                        <div className="relative">
                            <span className="material-icons absolute left-3 top-1/2 transform -translate-y-1/2 text-white/50">person</span>
                            <input
                                type="text"
                                className="w-full glass-card pl-10 p-3 rounded-lg border border-white/10 focus:outline-none focus:ring-2 focus:ring-primary/50"
                                value={name}
                                onChange={(e) => setName(e.target.value)}
                                required
                            />
                        </div>
                    </div>
                    
                    <div>
                        <label className="block text-sm text-white/70 mb-1">Email</label>
                        <div className="relative">
                            <span className="material-icons absolute left-3 top-1/2 transform -translate-y-1/2 text-white/50">email</span>
                            <input
                                type="email"
                                className="w-full glass-card pl-10 p-3 rounded-lg border border-white/10 focus:outline-none focus:ring-2 focus:ring-primary/50"
                                value={email}
                                onChange={(e) => setEmail(e.target.value)}
                                required
                            />
                        </div>
                    </div>
                    
                    <div>
                        <label className="block text-sm text-white/70 mb-1">Password</label>
                        <div className="relative">
                            <span className="material-icons absolute left-3 top-1/2 transform -translate-y-1/2 text-white/50">lock</span>
                            <input
                                type="password"
                                className="w-full glass-card pl-10 p-3 rounded-lg border border-white/10 focus:outline-none focus:ring-2 focus:ring-primary/50"
                                value={password}
                                onChange={(e) => setPassword(e.target.value)}
                                required
                                minLength="6"
                            />
                        </div>
                    </div>
                    
                    <div>
                        <label className="block text-sm text-white/70 mb-1">Confirm Password</label>
                        <div className="relative">
                            <span className="material-icons absolute left-3 top-1/2 transform -translate-y-1/2 text-white/50">lock</span>
                            <input
                                type="password"
                                className="w-full glass-card pl-10 p-3 rounded-lg border border-white/10 focus:outline-none focus:ring-2 focus:ring-primary/50"
                                value={confirmPassword}
                                onChange={(e) => setConfirmPassword(e.target.value)}
                                required
                                minLength="6"
                            />
                        </div>
                    </div>
                    
                    <div className="pt-2">
                        <motion.button
                            whileHover={{ scale: 1.02 }}
                            whileTap={{ scale: 0.98 }}
                            className="ripple w-full py-3 rounded-lg bg-gradient-to-r from-primary to-secondary text-white flex items-center justify-center"
                            type="submit"
                            disabled={isLoading}
                        >
                            {isLoading ? (
                                <motion.span
                                    animate={{ rotate: 360 }}
                                    transition={{ duration: 1, repeat: Infinity, ease: "linear" }}
                                    className="w-5 h-5 border-2 border-white border-t-transparent rounded-full"
                                />
                            ) : (
                                'Create Account'
                            )}
                        </motion.button>
                    </div>
                    
                    <div className="text-center text-sm text-white/70">
                        Already have an account?{' '}
                        <button 
                            type="button" 
                            className="text-primary hover:underline focus:outline-none"
                            onClick={onSwitchToLogin}
                        >
                            Sign in
                        </button>
                    </div>
                </form>
            );
        }
        
        // Header Component
        function Header() {
            const { user, theme } = useAppState();
            const { logout, toggleSettings, addNotification, toggleTheme } = useAppActions();
            const [isDropdownOpen, setIsDropdownOpen] = useState(false);
            const dropdownRef = useRef(null);
            
            // Close dropdown when clicking outside
            useEffect(() => {
                function handleClickOutside(event) {
                    if (dropdownRef.current && !dropdownRef.current.contains(event.target)) {
                        setIsDropdownOpen(false);
                    }
                }
                
                document.addEventListener('mousedown', handleClickOutside);
                return () => {
                    document.removeEventListener('mousedown', handleClickOutside);
                };
            }, []);
            
            const handleNotificationClick = () => {
                addNotification({
                    id: Date.now().toString(),
                    type: 'info',
                    message: 'This is a sample notification',
                    icon: 'info'
                });
            };
            
            return (
                <motion.header 
                    initial={{ y: -20, opacity: 0 }}
                    animate={{ y: 0, opacity: 1 }}
                    transition={{ duration: 0.5 }}
                    className={`${theme === 'dark' ? 'glass-card' : 'bg-white shadow-sm'} p-4 flex justify-between items-center sticky top-0 z-10`}
                >
                    <div className="flex items-center space-x-2">
                        <motion.div 
                            whileHover={{ rotate: 10 }}
                            className="w-10 h-10 rounded-full bg-gradient-to-r from-primary to-secondary flex items-center justify-center"
                        >
                            <span className="material-icons text-white">account_balance</span>
                        </motion.div>
                        <h1 className="text-xl font-bold gradient-text">Fintrak</h1>
                    </div>
                    
                    <div className="flex items-center space-x-4">
                        <motion.button
                            whileHover={{ scale: 1.1 }}
                            whileTap={{ scale: 0.9 }}
                            className="ripple p-2 rounded-full hover:bg-white/10 transition relative"
                            onClick={handleNotificationClick}
                            aria-label="Notifications"
                        >
                            <span className="material-icons">notifications</span>
                            <span className="absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full"></span>
                        </motion.button>
                        
                        <motion.button
                            whileHover={{ scale: 1.1 }}
                            whileTap={{ scale: 0.9 }}
                            className="ripple p-2 rounded-full hover:bg-white/10 transition"
                            onClick={toggleTheme}
                            aria-label="Toggle theme"
                        >
                            <span className="material-icons">
                                {theme === 'dark' ? 'light_mode' : 'dark_mode'}
                            </span>
                        </motion.button>
                        
                        <div className="relative" ref={dropdownRef}>
                            <motion.button
                                whileHover={{ scale: 1.05 }}
                                whileTap={{ scale: 0.95 }}
                                className="ripple flex items-center space-x-2 p-1 rounded-full hover:bg-white/10 transition"
                                onClick={() => setIsDropdownOpen(!isDropdownOpen)}
                                aria-label="User menu"
                            >
                                <div className="w-8 h-8 rounded-full overflow-hidden">
                                    <img src={user.avatar} alt={user.name} className="w-full h-full object-cover" />
                                </div>
                                <span className="hidden md:inline text-sm">{user.name}</span>
                                <span className="material-icons text-sm">
                                    {isDropdownOpen ? 'expand_less' : 'expand_more'}
                                </span>
                            </motion.button>
                            
                            <AnimatePresence>
                                {isDropdownOpen && (
                                    <motion.div
                                        initial={{ opacity: 0, y: 10 }}
                                        animate={{ opacity: 1, y: 0 }}
                                        exit={{ opacity: 0, y: 10 }}
                                        transition={{ duration: 0.2 }}
                                        className={`absolute right-0 mt-2 w-48 ${theme === 'dark' ? 'glass-card' : 'bg-white shadow-lg'} rounded-lg z-20`}
                                    >
                                        <div className="py-1">
                                            <button
                                                className="w-full text-left px-4 py-2 text-sm hover:bg-white/10 flex items-center"
                                                onClick={toggleSettings}
                                            >
                                                <span className="material-icons mr-2 text-sm">settings</span>
                                                Settings
                                            </button>
                                            <button
                                                className="w-full text-left px-4 py-2 text-sm hover:bg-white/10 flex items-center"
                                                onClick={logout}
                                            >
                                                <span className="material-icons mr-2 text-sm">logout</span>
                                                Logout
                                            </button>
                                        </div>
                                    </motion.div>
                                )}
                            </AnimatePresence>
                        </div>
                    </div>
                </motion.header>
            );
        }
        
        // Sidebar Component
        function Sidebar() {
            const { activeTab, theme } = useAppState();
            const { setActiveTab, toggleSettings } = useAppActions();
            
            const tabs = [
                { id: "dashboard", icon: "dashboard", label: "Dashboard" },
                { id: "expenses", icon: "receipt", label: "Expenses" },
                { id: "budgets", icon: "account_balance_wallet", label: "Budgets" },
                { id: "investments", icon: "trending_up", label: "Investments" },
                { id: "goals", icon: "savings", label: "Goals" },
                { id: "insights", icon: "insights", label: "AI Insights" },
            ];
            
            return (
                <motion.aside 
                    initial={{ x: -20, opacity: 0 }}
                    animate={{ x: 0, opacity: 1 }}
                    transition={{ duration: 0.5, delay: 0.2 }}
                    className={`hidden md:flex flex-col w-64 p-4 ${theme === 'dark' ? 'border-r border-white/10' : 'border-r border-gray-200'}`}
                >
                    <nav className="flex-1">
                        <ul className="space-y-1">
                            {tabs.map((tab) => (
                                <li key={tab.id}>
                                    <motion.button
                                        whileHover={{ scale: 1.02 }}
                                        whileTap={{ scale: 0.98 }}
                                        className={`ripple w-full flex items-center space-x-3 p-3 rounded-lg transition ${activeTab === tab.id ? (theme === 'dark' ? 'bg-white/10' : 'bg-gray-100') : (theme === 'dark' ? 'hover:bg-white/5' : 'hover:bg-gray-50')}`}
                                        onClick={() => setActiveTab(tab.id)}
                                    >
                                        <span className="material-icons">{tab.icon}</span>
                                        <span className={theme === 'dark' ? 'text-white' : 'text-gray-800'}>{tab.label}</span>
                                    </motion.button>
                                </li>
                            ))}
                        </ul>
                    </nav>
                    
                    <div className="mt-auto">
                        <motion.div
                            whileHover={{ scale: 1.02 }}
                            whileTap={{ scale: 0.98 }}
                            className={`${theme === 'dark' ? 'glass-card' : 'bg-gray-50'} p-3 rounded-lg mb-2`}
                        >
                            <div className="flex items-center justify-between">
                                <div>
                                    <p className={`text-xs ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'}`}>Total Balance</p>
                                    <p className={`font-medium ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>$12,456.78</p>
                                </div>
                                <div className="w-10 h-10 rounded-full bg-green-500/20 flex items-center justify-center">
                                    <span className="material-icons text-green-400">arrow_upward</span>
                                </div>
                            </div>
                        </motion.div>
                        
                        <motion.button
                            whileHover={{ scale: 1.02 }}
                            whileTap={{ scale: 0.98 }}
                            className={`ripple w-full flex items-center space-x-3 p-3 rounded-lg ${theme === 'dark' ? 'hover:bg-white/5' : 'hover:bg-gray-50'} transition`}
                            onClick={toggleSettings}
                        >
                            <span className="material-icons">settings</span>
                            <span className={theme === 'dark' ? 'text-white' : 'text-gray-800'}>Settings</span>
                        </motion.button>
                    </div>
                </motion.aside>
            );
        }
        
        // Mobile Navigation
        function MobileNav() {
            const { activeTab, theme } = useAppState();
            const { setActiveTab } = useAppActions();
            
            const tabs = [
                { id: "dashboard", icon: "dashboard", label: "Home" },
                { id: "expenses", icon: "receipt", label: "Expenses" },
                { id: "budgets", icon: "account_balance_wallet", label: "Budgets" },
                { id: "investments", icon: "trending_up", label: "Invest" },
                { id: "insights", icon: "insights", label: "AI" },
            ];
            
            return (
                <motion.div 
                    initial={{ y: 20, opacity: 0 }}
                    animate={{ y: 0, opacity: 1 }}
                    transition={{ duration: 0.5 }}
                    className={`md:hidden fixed bottom-0 left-0 right-0 ${theme === 'dark' ? 'glass-card' : 'bg-white'} ${theme === 'dark' ? 'border-t border-white/10' : 'border-t border-gray-200'} z-10`}
                >
                    <div className="flex justify-around p-2">
                        {tabs.map((tab) => (
                            <motion.button
                                key={tab.id}
                                whileTap={{ scale: 0.9 }}
                                className={`ripple flex flex-col items-center p-2 rounded-full ${activeTab === tab.id ? (theme === 'dark' ? 'bg-white/10' : 'bg-gray-100') : ''}`}
                                onClick={() => setActiveTab(tab.id)}
                                aria-label={tab.label}
                            >
                                <span className="material-icons">{tab.icon}</span>
                                <span className={`text-xs mt-1 ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>{tab.label}</span>
                            </motion.button>
                        ))}
                    </div>
                </motion.div>
            );
        }
        
        // Main Content Area
        function MainContent() {
            const { activeTab, theme } = useAppState();
            
            return (
                <main className={`flex-1 overflow-y-auto p-4 scrollbar-hide ${theme === 'dark' ? 'bg-gradient-to-br from-dark to-gray-900' : 'bg-gray-50'}`}>
                    <AnimatePresence mode="wait">
                        <motion.div
                            key={activeTab}
                            initial={{ opacity: 0, y: 10 }}
                            animate={{ opacity: 1, y: 0 }}
                            exit={{ opacity: 0, y: -10 }}
                            transition={{ duration: 0.3 }}
                        >
                            {activeTab === "dashboard" && <Dashboard />}
                            {activeTab === "expenses" && <Expenses />}
                            {activeTab === "budgets" && <Budgets />}
                            {activeTab === "investments" && <Investments />}
                            {activeTab === "goals" && <Goals />}
                            {activeTab === "insights" && <Insights />}
                        </motion.div>
                    </AnimatePresence>
                </main>
            );
        }
        
        // Dashboard Component
        function Dashboard() {
            const { 
                transactions, 
                investments, 
                budgets,
                goals,
                insights, 
                theme 
            } = useAppState();
            const { 
                toggleAddExpense, 
                toggleAddInvestment,
                toggleAddBudget,
                toggleAddGoal
            } = useAppActions();
            
            // Calculate totals
            const { totalExpenses, totalIncome, netWorth } = useMemo(() => {
                const totalExpenses = transactions
                    .filter(t => t.amount < 0)
                    .reduce((sum, t) => sum + Math.abs(t.amount), 0);
                
                const totalIncome = transactions
                    .filter(t => t.amount > 0)
                    .reduce((sum, t) => sum + t.amount, 0);
                
                const netWorth = totalIncome - totalExpenses + 
                    investments.reduce((sum, i) => sum + i.amount * (1 + i.roi/100), 0);
                
                return { totalExpenses, totalIncome, netWorth };
            }, [transactions, investments]);
            
            // Recent transactions
            const recentTransactions = useMemo(() => 
                [...transactions]
                    .sort((a, b) => new Date(b.date) - new Date(a.date))
                    .slice(0, 5),
                [transactions]
            );
            
            // Budget progress
            const budgetProgress = useMemo(() => 
                budgets.map(b => ({
                    category: b.category,
                    spent: b.spent,
                    total: b.amount,
                    percentage: Math.min(100, (b.spent / b.amount) * 100)
                })),
                [budgets]
            );
            
            // Goal progress
            const goalProgress = useMemo(() => 
                goals.map(g => ({
                    name: g.name,
                    saved: g.saved,
                    target: g.target,
                    percentage: Math.min(100, (g.saved / g.target) * 100)
                })),
                [goals]
            );
            
            return (
                <div className="space-y-6">
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <StatCard 
                            title="Net Worth" 
                            value={netWorth} 
                            icon="account_balance" 
                            color="from-purple-500 to-pink-500"
                            trend="up"
                            change="+2.5%"
                        />
						<StatCard 
						  title="Income" 
						  value={totalIncome} 
						  icon="arrow_upward" 
						  color="from-green-500 to-teal-500"
						  trend="up"
						  change={totalIncome > 0 ? `+${((totalIncome - prevMonthIncome)/prevMonthIncome*100).toFixed(1)}%` : '0%'}
						/>
                        <StatCard 
                            title="Expenses" 
                            value={totalExpenses} 
                            icon="arrow_downward" 
                            color="from-red-500 to-orange-500"
                            trend="down"
                            change="-3.2%"
                        />
                    </div>
                    
                    <div className="grid grid-cols-1 lg:grid-cols-3 gap-4">
                        <div className="lg:col-span-2 space-y-4">
                            <GlassCard title="Recent Transactions">
                                <div className="space-y-3">
                                    {recentTransactions.length > 0 ? (
                                        recentTransactions.map((t) => (
                                            <TransactionItem key={t.id} transaction={t} />
                                        ))
                                    ) : (
                                        <EmptyState 
                                            icon="receipt"
                                            title="No transactions yet"
                                            description="Start by adding your first expense or income"
                                            action={{
                                                label: "Add Expense",
                                                onClick: toggleAddExpense
                                            }}
                                        />
                                    )}
                                </div>
                                <div className="mt-4 flex justify-end">
                                    <motion.button
                                        whileHover={{ scale: 1.02 }}
                                        whileTap={{ scale: 0.98 }}
                                        className="ripple px-4 py-2 rounded-lg bg-gradient-to-r from-primary to-secondary text-white flex items-center"
                                        onClick={toggleAddExpense}
                                    >
                                        <span className="material-icons mr-1">add</span>
                                        Add Expense
                                    </motion.button>
                                </div>
                            </GlassCard>
                            
                            <GlassCard title="Budget Progress">
                                <div className="space-y-4">
                                    {budgetProgress.length > 0 ? (
                                        budgetProgress.map((budget) => (
                                            <BudgetProgressItem key={budget.category} budget={budget} />
                                        ))
                                    ) : (
                                        <EmptyState 
                                            icon="account_balance_wallet"
                                            title="No budgets set up"
                                            description="Create budgets to track your spending"
                                            action={{
                                                label: "Add Budget",
                                                onClick: toggleAddBudget
                                            }}
                                        />
                                    )}
                                </div>
                                <div className="mt-4 flex justify-end">
                                    <motion.button
                                        whileHover={{ scale: 1.02 }}
                                        whileTap={{ scale: 0.98 }}
                                        className="ripple px-4 py-2 rounded-lg bg-gradient-to-r from-blue-500 to-cyan-500 text-white flex items-center"
                                        onClick={toggleAddBudget}
                                    >
                                        <span className="material-icons mr-1">add</span>
                                        Add Budget
                                    </motion.button>
                                </div>
                            </GlassCard>
                        </div>
                        
                        <div className="space-y-4">
                            <GlassCard title="Investment Performance">
                                <div className="h-48">
                                    {investments.length > 0 ? (
                                        <PieChart data={investments.map(i => ({
                                            name: i.name,
                                            value: i.amount * (1 + i.roi/100),
                                            roi: i.roi
                                        }))} />
                                    ) : (
                                        <EmptyState 
                                            icon="trending_up"
                                            title="No investments"
                                            description="Track your investments to see performance"
                                            action={{
                                                label: "Add Investment",
                                                onClick: toggleAddInvestment
                                            }}
                                            small
                                        />
                                    )}
                                </div>
                                <div className="mt-4 flex justify-end">
                                    <motion.button
                                        whileHover={{ scale: 1.02 }}
                                        whileTap={{ scale: 0.98 }}
                                        className="ripple px-4 py-2 rounded-lg bg-gradient-to-r from-blue-500 to-cyan-500 text-white flex items-center"
                                        onClick={toggleAddInvestment}
                                    >
                                        <span className="material-icons mr-1">add</span>
                                        Add Investment
                                    </motion.button>
                                </div>
                            </GlassCard>

                            <GlassCard title="Goal Progress">
                                <div className="space-y-4">
                                    {goalProgress.length > 0 ? (
                                        goalProgress.map((goal) => (
                                            <GoalProgressItem key={goal.name} goal={goal} />
                                        ))
                                    ) : (
                                        <EmptyState 
                                            icon="savings"
                                            title="No goals set"
                                            description="Set financial goals to track your progress"
                                            action={{
                                                label: "Add Goal",
                                                onClick: toggleAddGoal
                                            }}
                                        />
                                    )}
                                </div>
                                <div className="mt-4 flex justify-end">
                                    <motion.button
                                        whileHover={{ scale: 1.02 }}
                                        whileTap={{ scale: 0.98 }}
                                        className="ripple px-4 py-2 rounded-lg bg-gradient-to-r from-primary to-secondary text-white flex items-center"
                                        onClick={toggleAddGoal}
                                    >
                                        <span className="material-icons mr-1">add</span>
                                        Add Goal
                                    </motion.button>
                                </div>
                            </GlassCard>

                            <GlassCard title="AI Insights">
                                <div className="space-y-3">
                                    {insights.length > 0 ? (
                                        insights.slice(0, 3).map((insight) => (
                                            <InsightItem key={insight.id} insight={insight} />
                                        ))
                                    ) : (
                                        <EmptyState 
                                            icon="insights"
                                            title="No insights yet"
                                            description="Add more data to generate personalized insights"
                                            small
                                        />
                                    )}
                                </div>
                                {insights.length > 3 && (
                                    <div className="mt-3 text-center">
                                        <button 
                                            className="text-sm text-primary hover:underline"
                                            onClick={() => setActiveTab("insights")}
                                        >
                                            View all insights
                                        </button>
                                    </div>
                                )}
                            </GlassCard>
                        </div>
                    </div>
                </div>
            );
        }

        // Stat Card Component
        function StatCard({ title, value, icon, color, trend, change }) {
            const { theme } = useAppState();
            
            return (
                <motion.div 
                    whileHover={{ y: -5 }}
                    className={`glass-card-hover p-5 rounded-xl bg-gradient-to-br ${color} relative overflow-hidden`}
                >
                    <div className="absolute top-0 right-0 w-32 h-32 rounded-full opacity-10 -mr-10 -mt-10 bg-white"></div>
                    <div className="relative z-10">
                        <div className="flex justify-between items-start">
                            <div>
                                <p className={`text-sm ${theme === 'dark' ? 'text-white/80' : 'text-white/90'}`}>{title}</p>
                                <h3 className={`text-2xl font-bold ${theme === 'dark' ? 'text-white' : 'text-white'}`}>
                                    {formatCurrency(value)}
                                </h3>
                            </div>
                            <div className={`w-10 h-10 rounded-full ${theme === 'dark' ? 'bg-white/10' : 'bg-white/20'} flex items-center justify-center`}>
                                <span className="material-icons text-white">{icon}</span>
                            </div>
                        </div>
                        <div className="mt-4 flex items-center">
                            <span className={`material-icons mr-1 text-sm ${trend === 'up' ? 'text-green-400' : 'text-red-400'}`}>
                                {trend === 'up' ? 'trending_up' : 'trending_down'}
                            </span>
                            <span className={`text-xs ${trend === 'up' ? 'text-green-400' : 'text-red-400'}`}>
                                {change}
                            </span>
                            <span className={`text-xs ml-1 ${theme === 'dark' ? 'text-white/70' : 'text-white/80'}`}>vs last month</span>
                        </div>
                    </div>
                </motion.div>
            );
        }

        // Glass Card Component (Wrapper)
        function GlassCard({ title, children, className = '' }) {
            const { theme } = useAppState();
            
            return (
                <div className={`${theme === 'dark' ? 'glass-card' : 'bg-white shadow-sm'} rounded-xl p-5 ${className}`}>
                    <div className="flex justify-between items-center mb-4">
                        <h3 className={`font-medium ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>{title}</h3>
                    </div>
                    {children}
                </div>
            );
        }

        // Transaction Item Component
        function TransactionItem({ transaction }) {
            const { theme } = useAppState();
            const { deleteTransaction } = useAppActions();
            const category = categories[transaction.category] || categories.other;
            const isExpense = transaction.amount < 0;
            
            return (
                <motion.div 
                    initial={{ opacity: 0, y: 10 }}
                    animate={{ opacity: 1, y: 0 }}
                    className={`flex items-center justify-between p-3 rounded-lg ${theme === 'dark' ? 'hover:bg-white/5' : 'hover:bg-gray-50'} transition`}
                >
                    <div className="flex items-center space-x-3">
                        <div className={`w-10 h-10 rounded-full ${category.color} flex items-center justify-center`}>
                            <span className="material-icons text-white">{category.icon}</span>
                        </div>
                        <div>
                            <p className={`text-sm ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                {transaction.description}
                            </p>
                            <p className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-500'}`}>
                                {formatDate(transaction.date)} • {category.name}
                            </p>
                        </div>
                    </div>
                    <div className="flex items-center space-x-2">
                        <p className={`font-medium ${isExpense ? 'text-red-400' : 'text-green-400'}`}>
                            {isExpense ? '-' : '+'}{formatCurrency(Math.abs(transaction.amount))}
                        </p>
                        <motion.button
                            whileHover={{ scale: 1.1 }}
                            whileTap={{ scale: 0.9 }}
                            className="ripple p-1 rounded-full hover:bg-white/10"
                            onClick={() => deleteTransaction(transaction.id)}
                            aria-label="Delete transaction"
                        >
                            <span className="material-icons text-sm text-white/50 hover:text-white">delete</span>
                        </motion.button>
                    </div>
                </motion.div>
            );
        }

        // Budget Progress Item Component
        function BudgetProgressItem({ budget }) {
            const { theme } = useAppState();
            const category = categories[budget.category] || categories.other;
            const percentage = budget.percentage;
            const isOverBudget = percentage > 100;
            
            return (
                <div>
                    <div className="flex justify-between items-center mb-1">
                        <div className="flex items-center space-x-2">
                            <div className={`w-6 h-6 rounded-full ${category.color} flex items-center justify-center`}>
                                <span className="material-icons text-white text-sm">{category.icon}</span>
                            </div>
                            <span className={`text-sm ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                {category.name}
                            </span>
                        </div>
                        <span className={`text-xs ${isOverBudget ? 'text-red-400' : 'text-green-400'}`}>
                            {percentage.toFixed(0)}%
                        </span>
                    </div>
                    <div className={`w-full h-2 rounded-full ${theme === 'dark' ? 'bg-white/10' : 'bg-gray-200'} overflow-hidden`}>
                        <motion.div 
                            initial={{ width: 0 }}
                            animate={{ width: `${Math.min(100, percentage)}%` }}
                            transition={{ duration: 0.8 }}
                            className={`h-full ${isOverBudget ? 'bg-red-500' : 'bg-primary'}`}
                        />
                    </div>
                    <div className="flex justify-between mt-1">
                        <span className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-500'}`}>
                            {formatCurrency(budget.spent)}
                        </span>
                        <span className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-500'}`}>
                            {formatCurrency(budget.total)}
                        </span>
                    </div>
                </div>
            );
        }

        // Goal Progress Item Component
        function GoalProgressItem({ goal }) {
            const { theme } = useAppState();
            const percentage = goal.percentage;
            
            return (
                <div>
                    <div className="flex justify-between items-center mb-1">
                        <span className={`text-sm ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                            {goal.name}
                        </span>
                        <span className={`text-xs ${percentage >= 100 ? 'text-green-400' : 'text-primary'}`}>
                            {percentage.toFixed(0)}%
                        </span>
                    </div>
                    <div className={`w-full h-2 rounded-full ${theme === 'dark' ? 'bg-white/10' : 'bg-gray-200'} overflow-hidden`}>
                        <motion.div 
                            initial={{ width: 0 }}
                            animate={{ width: `${percentage}%` }}
                            transition={{ duration: 0.8 }}
                            className={`h-full ${percentage >= 100 ? 'bg-green-500' : 'bg-primary'}`}
                        />
                    </div>
                    <div className="flex justify-between mt-1">
                        <span className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-500'}`}>
                            {formatCurrency(goal.saved)}
                        </span>
                        <span className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-500'}`}>
                            {formatCurrency(goal.target)}
                        </span>
                    </div>
                </div>
            );
        }

        // Insight Item Component
        function InsightItem({ insight }) {
            const { theme } = useAppState();
            const iconColor = {
                info: 'text-blue-400',
                warning: 'text-yellow-400',
                success: 'text-green-400',
                error: 'text-red-400'
            };
            
            return (
                <motion.div 
                    initial={{ opacity: 0, y: 10 }}
                    animate={{ opacity: 1, y: 0 }}
                    className={`flex items-start space-x-3 p-3 rounded-lg ${theme === 'dark' ? 'bg-white/5' : 'bg-gray-100'} transition`}
                >
                    <div className={`w-8 h-8 rounded-full ${theme === 'dark' ? 'bg-white/10' : 'bg-white'} flex items-center justify-center flex-shrink-0`}>
                        <span className={`material-icons ${iconColor[insight.type]}`}>{insight.icon}</span>
                    </div>
                    <div>
                        <p className={`text-sm ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                            {insight.message}
                        </p>
                        {insight.action && (
                            <p className={`text-xs mt-1 ${theme === 'dark' ? 'text-white/50' : 'text-gray-600'}`}>
                                {insight.action}
                            </p>
                        )}
                    </div>
                </motion.div>
            );
        }

        // Empty State Component
        function EmptyState({ icon, title, description, action, small = false }) {
            const { theme } = useAppState();
            
            return (
                <div className={`flex flex-col items-center justify-center ${small ? 'py-4' : 'py-8'} text-center`}>
                    <div className={`${small ? 'w-10 h-10' : 'w-16 h-16'} rounded-full ${theme === 'dark' ? 'bg-white/10' : 'bg-gray-200'} flex items-center justify-center mb-3`}>
                        <span className={`material-icons ${small ? 'text-xl' : 'text-2xl'} ${theme === 'dark' ? 'text-white/70' : 'text-gray-500'}`}>
                            {icon}
                        </span>
                    </div>
                    <h4 className={`${small ? 'text-sm' : 'text-base'} font-medium ${theme === 'dark' ? 'text-white' : 'text-gray-800'} mb-1`}>
                        {title}
                    </h4>
                    <p className={`${small ? 'text-xs' : 'text-sm'} ${theme === 'dark' ? 'text-white/50' : 'text-gray-500'} mb-3`}>
                        {description}
                    </p>
                    {action && (
                        <motion.button
                            whileHover={{ scale: 1.02 }}
                            whileTap={{ scale: 0.98 }}
                            className="ripple px-3 py-1.5 rounded-lg bg-gradient-to-r from-primary to-secondary text-white text-xs flex items-center"
                            onClick={action.onClick}
                        >
                            <span className="material-icons mr-1 text-sm">add</span>
                            {action.label}
                        </motion.button>
                    )}
                </div>
            );
        }

        // Pie Chart Component
        function PieChart({ data }) {
            const chartRef = useRef(null);
            const { theme } = useAppState();
            
            useEffect(() => {
                if (!chartRef.current || data.length === 0) return;
                
                const ctx = chartRef.current.getContext('2d');
                
                // Generate colors based on ROI (green for positive, red for negative)
                const backgroundColors = data.map(item => 
                    item.roi >= 0 ? 
                    `rgba(74, 222, 128, ${0.5 + (item.roi/100)})` : 
                    `rgba(248, 113, 113, ${0.5 + Math.abs(item.roi/100)})`
                );
                
                const borderColors = data.map(item => 
                    item.roi >= 0 ? 'rgba(74, 222, 128, 0.8)' : 'rgba(248, 113, 113, 0.8)'
                );
                
                const chart = new Chart(ctx, {
                    type: 'pie',
                    data: {
                        labels: data.map(item => item.name),
                        datasets: [{
                            data: data.map(item => item.value),
                            backgroundColor: backgroundColors,
                            borderColor: borderColors,
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'right',
                                labels: {
                                    color: theme === 'dark' ? '#f8fafc' : '#0f172a',
                                    font: {
                                        family: 'Poppins'
                                    }
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const label = context.label || '';
                                        const value = context.raw || 0;
                                        const roi = data[context.dataIndex].roi;
                                        return `${label}: ${formatCurrency(value)} (${roi >= 0 ? '+' : ''}${roi.toFixed(1)}%)`;
                                    }
                                }
                            }
                        }
                    }
                });
                
                return () => chart.destroy();
            }, [data, theme]);
            
            return <canvas ref={chartRef} />;
        }

        // Expenses Component
        function Expenses() {
            const { transactions, theme } = useAppState();
            const { toggleAddExpense, deleteTransaction } = useAppActions();
            
            // Group transactions by month
            const transactionsByMonth = useMemo(() => {
                const groups = {};
                
                transactions.forEach(t => {
                    const date = new Date(t.date);
                    const monthYear = `${date.toLocaleString('default', { month: 'long' })} ${date.getFullYear()}`;
                    
                    if (!groups[monthYear]) {
                        groups[monthYear] = [];
                    }
                    
                    groups[monthYear].push(t);
                });
                
                return Object.entries(groups)
                    .sort(([a], [b]) => new Date(b) - new Date(a));
            }, [transactions]);
            
            // Calculate category totals
            const categoryTotals = useMemo(() => {
                const totals = {};
                
                transactions
                    .filter(t => t.amount < 0)
                    .forEach(t => {
                        totals[t.category] = (totals[t.category] || 0) + Math.abs(t.amount);
                    });
                
                return Object.entries(totals)
                    .sort((a, b) => b[1] - a[1])
                    .map(([category, total]) => ({
                        category,
                        total,
                        ...(categories[category] || categories.other)
                    }));
            }, [transactions]);
            
            return (
                <div className="space-y-6">
                    <div className="flex justify-between items-center">
                        <h2 className={`text-xl font-bold ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                            Expense Tracking
                        </h2>
                        <motion.button
                            whileHover={{ scale: 1.02 }}
                            whileTap={{ scale: 0.98 }}
                            className="ripple px-4 py-2 rounded-lg bg-gradient-to-r from-primary to-secondary text-white flex items-center"
                            onClick={toggleAddExpense}
                        >
                            <span className="material-icons mr-1">add</span>
                            Add Expense
                        </motion.button>
                    </div>
                    
                    <div className="grid grid-cols-1 lg:grid-cols-3 gap-4">
                        <div className="lg:col-span-2">
                            <GlassCard title="Transaction History">
                                {transactionsByMonth.length > 0 ? (
                                    transactionsByMonth.map(([monthYear, monthTransactions]) => (
                                        <div key={monthYear} className="mb-6">
                                            <div className="flex justify-between items-center mb-3">
                                                <h4 className={`font-medium ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                                    {monthYear}
                                                </h4>
                                                <p className={`text-sm ${theme === 'dark' ? 'text-white/50' : 'text-gray-500'}`}>
                                                    Total: {formatCurrency(
                                                        monthTransactions
                                                            .filter(t => t.amount < 0)
                                                            .reduce((sum, t) => sum + Math.abs(t.amount), 0)
                                                    )}
                                                </p>
                                            </div>
                                            <div className="space-y-2">
                                                {monthTransactions
                                                    .sort((a, b) => new Date(b.date) - new Date(a.date))
                                                    .map(t => (
                                                        <TransactionItem 
                                                            key={t.id} 
                                                            transaction={t} 
                                                            onDelete={() => deleteTransaction(t.id)}
                                                        />
                                                    ))
                                                }
                                            </div>
                                        </div>
                                    ))
                                ) : (
                                    <EmptyState 
                                        icon="receipt"
                                        title="No transactions yet"
                                        description="Start by adding your first expense"
                                        action={{
                                            label: "Add Expense",
                                            onClick: toggleAddExpense
                                        }}
                                    />
                                )}
                            </GlassCard>
                        </div>
                        
                        <div className="space-y-4">
                            <GlassCard title="Spending by Category">
                                {categoryTotals.length > 0 ? (
                                    <>
                                        <div className="h-64">
                                            <BarChart 
                                                data={categoryTotals.map(c => ({
                                                    name: c.name,
                                                    value: c.total,
                                                    color: c.color
                                                }))} 
                                            />
                                        </div>
                                        <div className="mt-4 space-y-3">
                                            {categoryTotals.map(category => (
                                                <div key={category.category} className="flex items-center justify-between">
                                                    <div className="flex items-center space-x-2">
                                                        <div className={`w-4 h-4 rounded-full ${category.color}`}></div>
                                                        <span className={`text-sm ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                                            {category.name}
                                                        </span>
                                                    </div>
                                                    <span className={`text-sm ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'}`}>
                                                        {formatCurrency(category.total)}
                                                    </span>
                                                </div>
                                            ))}
                                        </div>
                                    </>
                                ) : (
                                    <EmptyState 
                                        icon="pie_chart"
                                        title="No spending data"
                                        description="Add expenses to see category breakdown"
                                        small
                                    />
                                )}
                            </GlassCard>
                            
                            <GlassCard title="Quick Actions">
                                <div className="grid grid-cols-2 gap-3">
                                    <motion.button
                                        whileHover={{ scale: 1.02 }}
                                        whileTap={{ scale: 0.98 }}
                                        className="ripple p-3 rounded-lg bg-white/5 flex flex-col items-center justify-center"
                                        onClick={toggleAddExpense}
                                    >
                                        <span className="material-icons text-primary mb-1">add</span>
                                        <span className={`text-xs ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>Add Expense</span>
                                    </motion.button>
                                    <motion.button
                                        whileHover={{ scale: 1.02 }}
                                        whileTap={{ scale: 0.98 }}
                                        className="ripple p-3 rounded-lg bg-white/5 flex flex-col items-center justify-center"
                                        onClick={() => {}}
                                    >
                                        <span className="material-icons text-blue-400 mb-1">receipt</span>
                                        <span className={`text-xs ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>Scan Receipt</span>
                                    </motion.button>
                                    <motion.button
                                        whileHover={{ scale: 1.02 }}
                                        whileTap={{ scale: 0.98 }}
                                        className="ripple p-3 rounded-lg bg-white/5 flex flex-col items-center justify-center"
                                        onClick={() => {}}
                                    >
                                        <span className="material-icons text-purple-400 mb-1">file_download</span>
                                        <span className={`text-xs ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>Import</span>
                                    </motion.button>
                                    <motion.button
                                        whileHover={{ scale: 1.02 }}
                                        whileTap={{ scale: 0.98 }}
                                        className="ripple p-3 rounded-lg bg-white/5 flex flex-col items-center justify-center"
                                        onClick={() => {}}
                                    >
                                        <span className="material-icons text-green-400 mb-1">insights</span>
                                        <span className={`text-xs ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>Reports</span>
                                    </motion.button>
                                </div>
                            </GlassCard>
                        </div>
                    </div>
                </div>
            );
        }

        // Bar Chart Component
        function BarChart({ data }) {
            const chartRef = useRef(null);
            const { theme } = useAppState();
            
            useEffect(() => {
                if (!chartRef.current || data.length === 0) return;
                
                const ctx = chartRef.current.getContext('2d');
                
                const chart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: data.map(item => item.name),
                        datasets: [{
                            data: data.map(item => item.value),
                            backgroundColor: data.map(item => 
                                theme === 'dark' ? 
                                item.color.replace('bg-', 'rgba(').replace('-', ', 0.7)') :
                                item.color.replace('bg-', 'rgba(').replace('-', ', 0.5)')
                            ),
                            borderColor: data.map(item => 
                                item.color.replace('bg-', 'rgba(').replace('-', ', 0.8)')
                            ),
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return formatCurrency(context.raw);
                                    }
                                }
                            }
                        },
						scales: {
						  x: {
							grid: {
							  color: theme === 'dark' ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
							},
							ticks: {
							  color: theme === 'dark' ? '#f8fafc' : '#0f172a',
							  font: {
								family: 'Poppins'
							  }
							}
						  },
						  y: {
							grid: {
							  color: theme === 'dark' ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
							},
							ticks: {
							  color: theme === 'dark' ? '#f8fafc' : '#0f172a',
							  font: {
								family: 'Poppins'
							  },
							  callback: function(value) {
								return formatCurrency(value);
							  }
							}
						  }
						}
                    }
                });
                
                return () => chart.destroy();
            }, [data, theme]);
            
            return <canvas ref={chartRef} />;
        }

        // Budgets Component
        function Budgets() {
            const { budgets, theme } = useAppState();
            const { toggleAddBudget } = useAppActions();
            
            // Calculate budget progress
            const budgetProgress = useMemo(() => 
                budgets.map(b => ({
                    ...b,
                    percentage: Math.min(100, (b.spent / b.amount) * 100),
                    categoryInfo: categories[b.category] || categories.other
                })),
                [budgets]
            );
            
            // Calculate total budget and spent
            const { totalBudget, totalSpent } = useMemo(() => ({
                totalBudget: budgets.reduce((sum, b) => sum + b.amount, 0),
                totalSpent: budgets.reduce((sum, b) => sum + b.spent, 0)
            }), [budgets]);
            
            return (
                <div className="space-y-6">
                    <div className="flex justify-between items-center">
                        <h2 className={`text-xl font-bold ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                            Budget Management
                        </h2>
                        <motion.button
                            whileHover={{ scale: 1.02 }}
                            whileTap={{ scale: 0.98 }}
                            className="ripple px-4 py-2 rounded-lg bg-gradient-to-r from-primary to-secondary text-white flex items-center"
                            onClick={toggleAddBudget}
                        >
                            <span className="material-icons mr-1">add</span>
                            Add Budget
                        </motion.button>
                    </div>
                    
                    <div className="grid grid-cols-1 lg:grid-cols-3 gap-4">
                        <div className="lg:col-span-2">
                            <GlassCard title="Your Budgets">
                                {budgetProgress.length > 0 ? (
                                    <div className="space-y-4">
                                        {budgetProgress.map(budget => (
                                            <div key={budget.id} className="p-4 rounded-lg bg-white/5">
                                                <div className="flex justify-between items-center mb-2">
                                                    <div className="flex items-center space-x-3">
                                                        <div className={`w-10 h-10 rounded-full ${budget.categoryInfo.color} flex items-center justify-center`}>
                                                            <span className="material-icons text-white">{budget.categoryInfo.icon}</span>
                                                        </div>
                                                        <div>
                                                            <h4 className={`font-medium ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                                                {budget.categoryInfo.name}
                                                            </h4>
                                                            <p className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-500'}`}>
                                                                {formatCurrency(budget.spent)} of {formatCurrency(budget.amount)}
                                                            </p>
                                                        </div>
                                                    </div>
                                                    <span className={`text-sm font-medium ${budget.percentage > 90 ? 'text-red-400' : 'text-green-400'}`}>
                                                        {budget.percentage.toFixed(0)}%
                                                    </span>
                                                </div>
                                                <div className={`w-full h-2 rounded-full ${theme === 'dark' ? 'bg-white/10' : 'bg-gray-200'} overflow-hidden`}>
                                                    <div 
                                                        className={`h-full ${budget.percentage > 90 ? 'bg-red-500' : 'bg-primary'}`}
                                                        style={{ width: `${budget.percentage}%` }}
                                                    />
                                                </div>
                                                <div className="flex justify-between mt-3">
                                                    <span className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-500'}`}>
                                                        {formatCurrency(budget.amount - budget.spent)} remaining
                                                    </span>
                                                    <span className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-500'}`}>
                                                        {formatCurrency(budget.amount)} total
                                                    </span>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                ) : (
                                    <EmptyState 
                                        icon="account_balance_wallet"
                                        title="No budgets set up"
                                        description="Create budgets to track your spending"
                                        action={{
                                            label: "Add Budget",
                                            onClick: toggleAddBudget
                                        }}
                                    />
                                )}
                            </GlassCard>
                        </div>
                        
                        <div className="space-y-4">
                            <GlassCard title="Budget Overview">
                                <div className="space-y-4">
                                    <div>
                                        <p className={`text-sm ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'} mb-1`}>Total Budget</p>
                                        <h3 className={`text-2xl font-bold ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                            {formatCurrency(totalBudget)}
                                        </h3>
                                    </div>
                                    
                                    <div>
                                        <p className={`text-sm ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'} mb-1`}>Total Spent</p>
                                        <h3 className={`text-2xl font-bold ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                            {formatCurrency(totalSpent)}
                                        </h3>
                                    </div>
                                    
                                    <div>
                                        <p className={`text-sm ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'} mb-1`}>Remaining</p>
                                        <h3 className={`text-2xl font-bold ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                            {formatCurrency(totalBudget - totalSpent)}
                                        </h3>
                                    </div>
                                    
                                    <div className="pt-2">
                                        <div className={`w-full h-2 rounded-full ${theme === 'dark' ? 'bg-white/10' : 'bg-gray-200'} overflow-hidden`}>
                                            <div 
                                                className="h-full bg-gradient-to-r from-primary to-secondary"
                                                style={{ width: `${(totalSpent / totalBudget) * 100}%` }}
                                            />
                                        </div>
                                        <div className="flex justify-between mt-1">
                                            <span className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-500'}`}>0%</span>
                                            <span className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-500'}`}>
                                                {((totalSpent / totalBudget) * 100).toFixed(0)}%
                                            </span>
                                            <span className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-500'}`}>100%</span>
                                        </div>
                                    </div>
                                </div>
                            </GlassCard>
                            
                            <GlassCard title="Budget Tips">
                                <div className="space-y-3">
                                    <div className="flex items-start space-x-3">
                                        <span className="material-icons text-primary">lightbulb</span>
                                        <div>
                                            <h4 className={`font-medium ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                                50/30/20 Rule
                                            </h4>
                                            <p className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-600'}`}>
                                                Allocate 50% to needs, 30% to wants, and 20% to savings.
                                            </p>
                                        </div>
                                    </div>
                                    <div className="flex items-start space-x-3">
                                        <span className="material-icons text-blue-400">calendar_today</span>
                                        <div>
                                            <h4 className={`font-medium ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                                Review Weekly
                                            </h4>
                                            <p className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-600'}`}>
                                                Check your budget weekly to stay on track.
                                            </p>
                                        </div>
                                    </div>
                                    <div className="flex items-start space-x-3">
                                        <span className="material-icons text-green-400">trending_up</span>
                                        <div>
                                            <h4 className={`font-medium ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                                Adjust as Needed
                                            </h4>
                                            <p className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-600'}`}>
                                                Don't be afraid to adjust your budget as circumstances change.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </GlassCard>
                        </div>
                    </div>
                </div>
            );
        }

        // Investments Component
        function Investments() {
            const { investments, theme } = useAppState();
            const { toggleAddInvestment, deleteInvestment } = useAppActions();
            
            // Calculate totals
            const { totalInvested, totalValue, totalGain } = useMemo(() => {
                const totalInvested = investments.reduce((sum, i) => sum + i.amount, 0);
                const totalValue = investments.reduce((sum, i) => sum + i.amount * (1 + i.roi/100), 0);
                const totalGain = totalValue - totalInvested;
                
                return { totalInvested, totalValue, totalGain };
            }, [investments]);
            
            return (
                <div className="space-y-6">
                    <div className="flex justify-between items-center">
                        <h2 className={`text-xl font-bold ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                            Investment Portfolio
                        </h2>
                        <motion.button
                            whileHover={{ scale: 1.02 }}
                            whileTap={{ scale: 0.98 }}
                            className="ripple px-4 py-2 rounded-lg bg-gradient-to-r from-primary to-secondary text-white flex items-center"
                            onClick={toggleAddInvestment}
                        >
                            <span className="material-icons mr-1">add</span>
                            Add Investment
                        </motion.button>
                    </div>
                    
                    <div className="grid grid-cols-1 lg:grid-cols-3 gap-4">
                        <div className="lg:col-span-2">
                            <GlassCard title="Your Investments">
                                {investments.length > 0 ? (
                                    <div className="space-y-3">
                                        {investments.map(investment => (
                                            <InvestmentItem 
                                                key={investment.id} 
                                                investment={investment} 
                                                onDelete={() => deleteInvestment(investment.id)}
                                            />
                                        ))}
                                    </div>
                                ) : (
                                    <EmptyState 
                                        icon="trending_up"
                                        title="No investments yet"
                                        description="Start by adding your first investment"
                                        action={{
                                            label: "Add Investment",
                                            onClick: toggleAddInvestment
                                        }}
                                    />
                                )}
                            </GlassCard>
                        </div>
                        
                        <div className="space-y-4">
                            <GlassCard title="Portfolio Summary">
                                <div className="space-y-4">
                                    <div>
                                        <p className={`text-sm ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'} mb-1`}>Total Invested</p>
                                        <h3 className={`text-2xl font-bold ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                            {formatCurrency(totalInvested)}
                                        </h3>
                                    </div>
                                    
                                    <div>
                                        <p className={`text-sm ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'} mb-1`}>Current Value</p>
                                        <h3 className={`text-2xl font-bold ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                            {formatCurrency(totalValue)}
                                        </h3>
                                    </div>
                                    
                                    <div>
                                        <p className={`text-sm ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'} mb-1`}>Total Gain/Loss</p>
                                        <h3 className={`text-2xl font-bold ${totalGain >= 0 ? 'text-green-400' : 'text-red-400'}`}>
                                            {totalGain >= 0 ? '+' : ''}{formatCurrency(totalGain)} ({((totalGain / totalInvested) * 100).toFixed(1)}%)
                                        </h3>
                                    </div>
                                </div>
                            </GlassCard>
                            
                            <GlassCard title="Performance">
                                <div className="h-48">
                                    {investments.length > 0 ? (
                                        <PieChart 
                                            data={investments.map(i => ({
                                                name: i.name,
                                                value: i.amount * (1 + i.roi/100),
                                                roi: i.roi
                                            }))} 
                                        />
                                    ) : (
                                        <EmptyState 
                                            icon="pie_chart"
                                            title="No data"
                                            description="Add investments to see performance"
                                            small
                                        />
                                    )}
                                </div>
                            </GlassCard>
                            
                            <GlassCard title="Quick Actions">
                                <div className="grid grid-cols-2 gap-3">
                                    <motion.button
                                        whileHover={{ scale: 1.02 }}
                                        whileTap={{ scale: 0.98 }}
                                        className="ripple p-3 rounded-lg bg-white/5 flex flex-col items-center justify-center"
                                        onClick={toggleAddInvestment}
                                    >
                                        <span className="material-icons text-primary mb-1">add</span>
                                        <span className={`text-xs ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>Add Investment</span>
                                    </motion.button>
                                    <motion.button
                                        whileHover={{ scale: 1.02 }}
                                        whileTap={{ scale: 0.98 }}
                                        className="ripple p-3 rounded-lg bg-white/5 flex flex-col items-center justify-center"
                                        onClick={() => {}}
                                    >
                                        <span className="material-icons text-blue-400 mb-1">sync</span>
                                        <span className={`text-xs ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>Refresh Prices</span>
                                    </motion.button>
                                    <motion.button
                                        whileHover={{ scale: 1.02 }}
                                        whileTap={{ scale: 0.98 }}
                                        className="ripple p-3 rounded-lg bg-white/5 flex flex-col items-center justify-center"
                                        onClick={() => {}}
                                    >
                                        <span className="material-icons text-purple-400 mb-1">timeline</span>
                                        <span className={`text-xs ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>View Chart</span>
                                    </motion.button>
                                    <motion.button
                                        whileHover={{ scale: 1.02 }}
                                        whileTap={{ scale: 0.98 }}
                                        className="ripple p-3 rounded-lg bg-white/5 flex flex-col items-center justify-center"
                                        onClick={() => {}}
                                    >
                                        <span className="material-icons text-green-400 mb-1">file_download</span>
                                        <span className={`text-xs ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>Export Data</span>
                                    </motion.button>
                                </div>
                            </GlassCard>
                        </div>
                    </div>
                </div>
            );
        }

        // Investment Item Component
        function InvestmentItem({ investment, onDelete }) {
            const { theme } = useAppState();
            const type = investmentTypes[investment.type] || investmentTypes.stocks;
            const currentValue = investment.amount * (1 + investment.roi/100);
            const gain = currentValue - investment.amount;
            
            return (
                <motion.div 
                    initial={{ opacity: 0, y: 10 }}
                    animate={{ opacity: 1, y: 0 }}
                    className={`flex items-center justify-between p-3 rounded-lg ${theme === 'dark' ? 'hover:bg-white/5' : 'hover:bg-gray-50'} transition`}
                >
                    <div className="flex items-center space-x-3">
                        <div className={`w-10 h-10 rounded-full ${type.color} flex items-center justify-center`}>
                            <span className="material-icons text-white">{type.icon}</span>
                        </div>
                        <div>
                            <p className={`text-sm ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                {investment.name}
                            </p>
                            <p className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-500'}`}>
                                {type.name} • {formatDate(investment.date)}
                            </p>
                        </div>
                    </div>
                    <div className="flex items-center space-x-4">
                        <div className="text-right">
                            <p className={`text-sm font-medium ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                {formatCurrency(currentValue)}
                            </p>
                            <p className={`text-xs ${gain >= 0 ? 'text-green-400' : 'text-red-400'}`}>
                                {gain >= 0 ? '+' : ''}{formatCurrency(gain)} ({investment.roi >= 0 ? '+' : ''}{investment.roi.toFixed(1)}%)
                            </p>
                        </div>
                        <motion.button
                            whileHover={{ scale: 1.1 }}
                            whileTap={{ scale: 0.9 }}
                            className="ripple p-1 rounded-full hover:bg-white/10"
                            onClick={onDelete}
                            aria-label="Delete investment"
                        >
                            <span className="material-icons text-sm text-white/50 hover:text-white">delete</span>
                        </motion.button>
                    </div>
                </motion.div>
            );
        }

        // Goals Component
        function Goals() {
            const { goals, theme } = useAppState();
            const { toggleAddGoal, addToGoal, deleteGoal } = useAppActions();
            
            // Calculate goal progress
				const goalProgress = useMemo(() => 
				goals.map(g => ({
					...g,
					percentage: Math.min(100, (g.saved / g.target) * 100),
					daysRemaining: Math.ceil((new Date(g.deadline) - new Date()) / (1000 * 60 * 60 * 24))
				})),
				[goals]
			);
            
            // Calculate totals
            const { totalSaved, totalTarget } = useMemo(() => ({
                totalSaved: goals.reduce((sum, g) => sum + g.saved, 0),
                totalTarget: goals.reduce((sum, g) => sum + g.target, 0)
            }), [goals]);
            
            return (
                <div className="space-y-6">
                    <div className="flex justify-between items-center">
                        <h2 className={`text-xl font-bold ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                            Financial Goals
                        </h2>
                        <motion.button
                            whileHover={{ scale: 1.02 }}
                            whileTap={{ scale: 0.98 }}
                            className="ripple px-4 py-2 rounded-lg bg-gradient-to-r from-primary to-secondary text-white flex items-center"
                            onClick={toggleAddGoal}
                        >
                            <span className="material-icons mr-1">add</span>
                            Add Goal
                        </motion.button>
                    </div>
                    
                    <div className="grid grid-cols-1 lg:grid-cols-3 gap-4">
                        <div className="lg:col-span-2">
                            <GlassCard title="Your Goals">
                                {goalProgress.length > 0 ? (
                                    <div className="space-y-4">
                                        {goalProgress.map(goal => (
                                            <GoalItem 
                                                key={goal.id} 
                                                goal={goal} 
                                                onAdd={() => {
                                                    const amount = parseFloat(prompt('How much to add to this goal?'));
                                                    if (!isNaN(amount)) {
                                                        addToGoal(goal.id, amount);
                                                    }
                                                }}
                                                onDelete={() => deleteGoal(goal.id)}
                                            />
                                        ))}
                                    </div>
                                ) : (
                                    <EmptyState 
                                        icon="savings"
                                        title="No goals yet"
                                        description="Set financial goals to track your progress"
                                        action={{
                                            label: "Add Goal",
                                            onClick: toggleAddGoal
                                        }}
                                    />
                                )}
                            </GlassCard>
                        </div>
                        
                        <div className="space-y-4">
                            <GlassCard title="Goals Summary">
                                <div className="space-y-4">
                                    <div>
                                        <p className={`text-sm ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'} mb-1`}>Total Saved</p>
                                        <h3 className={`text-2xl font-bold ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                            {formatCurrency(totalSaved)}
                                        </h3>
                                    </div>
                                    
                                    <div>
                                        <p className={`text-sm ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'} mb-1`}>Total Target</p>
                                        <h3 className={`text-2xl font-bold ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                            {formatCurrency(totalTarget)}
                                        </h3>
                                    </div>
                                    
                                    <div>
                                        <p className={`text-sm ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'} mb-1`}>Remaining</p>
                                        <h3 className={`text-2xl font-bold ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                            {formatCurrency(totalTarget - totalSaved)}
                                        </h3>
                                    </div>
                                    
                                    <div className="pt-2">
                                        <div className={`w-full h-2 rounded-full ${theme === 'dark' ? 'bg-white/10' : 'bg-gray-200'} overflow-hidden`}>
                                            <div 
                                                className="h-full bg-gradient-to-r from-primary to-secondary"
                                                style={{ width: `${(totalSaved / totalTarget) * 100}%` }}
                                            />
                                        </div>
                                        <div className="flex justify-between mt-1">
                                            <span className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-500'}`}>0%</span>
                                            <span className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-500'}`}>
                                                {((totalSaved / totalTarget) * 100).toFixed(0)}%
                                            </span>
                                            <span className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-500'}`}>100%</span>
                                        </div>
                                    </div>
                                </div>
                            </GlassCard>
                            
                            <GlassCard title="Tips for Saving">
                                <div className="space-y-3">
                                    <div className="flex items-start space-x-3">
                                        <span className="material-icons text-primary">savings</span>
                                        <div>
                                            <h4 className={`font-medium ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                                Automate Savings
                                            </h4>
                                            <p className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-600'}`}>
                                                Set up automatic transfers to your savings account.
                                            </p>
                                        </div>
                                    </div>
                                    <div className="flex items-start space-x-3">
                                        <span className="material-icons text-blue-400">paid</span>
                                        <div>
                                            <h4 className={`font-medium ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                                Cut Unnecessary Expenses
                                            </h4>
                                            <p className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-600'}`}>
                                                Review your spending and cut back where possible.
                                            </p>
                                        </div>
                                    </div>
                                    <div className="flex items-start space-x-3">
                                        <span className="material-icons text-green-400">track_changes</span>
                                        <div>
                                            <h4 className={`font-medium ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                                Track Progress
                                            </h4>
                                            <p className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-600'}`}>
                                                Regularly check your progress toward each goal.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </GlassCard>
                        </div>
                    </div>
                </div>
            );
        }

        // Goal Item Component
        function GoalItem({ goal, onAdd, onDelete }) {
            const { theme } = useAppState();
            const daysRemaining = Math.ceil((new Date(goal.deadline) - new Date()) / (1000 * 60 * 60 * 24));
            const isOverdue = daysRemaining < 0;
            
            return (
                <motion.div 
                    initial={{ opacity: 0, y: 10 }}
                    animate={{ opacity: 1, y: 0 }}
                    className={`p-4 rounded-lg ${theme === 'dark' ? 'bg-white/5' : 'bg-gray-100'}`}
                >
                    <div className="flex justify-between items-center mb-2">
                        <h4 className={`font-medium ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                            {goal.name}
                        </h4>
                        <span className={`text-xs ${goal.percentage >= 100 ? 'text-green-400' : 'text-primary'}`}>
                            {goal.percentage.toFixed(0)}%
                        </span>
                    </div>
                    
                    <div className={`w-full h-2 rounded-full ${theme === 'dark' ? 'bg-white/10' : 'bg-gray-200'} overflow-hidden mb-3`}>
                        <div 
                            className={`h-full ${goal.percentage >= 100 ? 'bg-green-500' : 'bg-primary'}`}
                            style={{ width: `${goal.percentage}%` }}
                        />
                    </div>
                    
                    <div className="flex justify-between items-center mb-3">
                        <div>
                            <p className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-500'}`}>
                                Saved: {formatCurrency(goal.saved)}
                            </p>
                            <p className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-500'}`}>
                                Target: {formatCurrency(goal.target)}
                            </p>
                        </div>
                        <div className="text-right">
                            <p className={`text-xs ${isOverdue ? 'text-red-400' : theme === 'dark' ? 'text-white/50' : 'text-gray-500'}`}>
                                {isOverdue ? 'Overdue' : `${daysRemaining} days remaining`}
                            </p>
                            <p className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-500'}`}>
                                Deadline: {formatDate(goal.deadline)}
                            </p>
                        </div>
                    </div>
                    
                    <div className="flex justify-between space-x-2">
                        <motion.button
                            whileHover={{ scale: 1.02 }}
                            whileTap={{ scale: 0.98 }}
                            className="ripple flex-1 py-1.5 rounded-lg bg-gradient-to-r from-primary to-secondary text-white text-xs flex items-center justify-center"
                            onClick={onAdd}
                        >
                            <span className="material-icons mr-1 text-sm">add</span>
                            Add Money
                        </motion.button>
                        <motion.button
                            whileHover={{ scale: 1.02 }}
                            whileTap={{ scale: 0.98 }}
                            className="ripple flex-1 py-1.5 rounded-lg bg-white/5 text-white text-xs flex items-center justify-center"
                            onClick={() => {}}
                        >
                            <span className="material-icons mr-1 text-sm">edit</span>
                            Edit
                        </motion.button>
                        <motion.button
                            whileHover={{ scale: 1.02 }}
                            whileTap={{ scale: 0.98 }}
                            className="ripple flex-1 py-1.5 rounded-lg bg-white/5 text-white text-xs flex items-center justify-center"
                            onClick={onDelete}
                        >
                            <span className="material-icons mr-1 text-sm">delete</span>
                            Delete
                        </motion.button>
                    </div>
                </motion.div>
            );
        }

        // Insights Component
        function Insights() {
            const { insights, theme } = useAppState();
            
            return (
                <div className="space-y-6">
                    <div className="flex justify-between items-center">
                        <h2 className={`text-xl font-bold ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                            AI-Powered Insights
                        </h2>
                    </div>
                    
                    <GlassCard title="Personalized Recommendations">
                        {insights.length > 0 ? (
                            <div className="space-y-3">
                                {insights.map(insight => (
                                    <InsightItem key={insight.id} insight={insight} />
                                ))}
                            </div>
                        ) : (
                            <EmptyState 
                                icon="insights"
                                title="No insights yet"
                                description="Add more financial data to generate personalized insights"
                            />
                        )}
                    </GlassCard>
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <GlassCard title="Spending Patterns">
                            <div className="h-64">
                                {insights.length > 0 ? (
                                    <div className="flex items-center justify-center h-full">
                                        <span className="material-icons text-4xl text-primary">bar_chart</span>
                                    </div>
                                ) : (
                                    <EmptyState 
                                        icon="bar_chart"
                                        title="No data"
                                        description="Add more transactions to analyze spending patterns"
                                        small
                                    />
                                )}
                            </div>
                        </GlassCard>
                        
                        <GlassCard title="Savings Rate">
                            <div className="h-64">
                                {insights.length > 0 ? (
                                    <div className="flex items-center justify-center h-full">
                                        <span className="material-icons text-4xl text-primary">pie_chart</span>
                                    </div>
                                ) : (
                                    <EmptyState 
                                        icon="pie_chart"
                                        title="No data"
                                        description="Add income and expenses to calculate savings rate"
                                        small
                                    />
                                )}
                            </div>
                        </GlassCard>
                    </div>
                </div>
            );
        }

        // Add Expense Modal
        function AddExpenseModal() {
            const { isAddExpenseOpen, theme } = useAppState();
            const { toggleAddExpense, addTransaction } = useAppActions();
            
            const [amount, setAmount] = useState('');
            const [category, setCategory] = useState('food');
            const [date, setDate] = useState(new Date().toISOString().split('T')[0]);
            const [description, setDescription] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            
            const handleSubmit = (e) => {
                e.preventDefault();
                setIsLoading(true);
                
                const newTransaction = {
                    id: Date.now().toString(),
                    amount: -Math.abs(parseFloat(amount)),
                    category,
                    date,
                    description: description || `Expense: ${categories[category].name}`
                };
                
                setTimeout(() => {
                    addTransaction(newTransaction);
                    toggleAddExpense();
                    setAmount('');
                    setCategory('food');
                    setDate(new Date().toISOString().split('T')[0]);
                    setDescription('');
                    setIsLoading(false);
                }, 500);
            };
            
            return (
                <Modal isOpen={isAddExpenseOpen} onClose={toggleAddExpense} title="Add Expense">
                    <form onSubmit={handleSubmit} className="space-y-4">
                        <div>
                            <label className={`block text-sm mb-1 ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'}`}>
                                Amount
                            </label>
                            <div className="relative">
                                <span className="material-icons absolute left-3 top-1/2 transform -translate-y-1/2 text-white/50">attach_money</span>
                                <input
                                    type="number"
                                    step="0.01"
                                    min="0.01"
                                    className={`w-full ${theme === 'dark' ? 'glass-card' : 'bg-white'} pl-10 p-3 rounded-lg border ${theme === 'dark' ? 'border-white/10' : 'border-gray-200'} focus:outline-none focus:ring-2 focus:ring-primary/50`}
                                    value={amount}
                                    onChange={(e) => setAmount(e.target.value)}
                                    required
                                />
                            </div>
                        </div>
                        
                        <div>
                            <label className={`block text-sm mb-1 ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'}`}>
                                Category
                            </label>
                            <div className="grid grid-cols-4 gap-2">
                                {Object.entries(categories).map(([key, cat]) => (
                                    <motion.button
                                        key={key}
                                        whileHover={{ scale: 1.05 }}
                                        whileTap={{ scale: 0.95 }}
                                        type="button"
                                        className={`ripple flex flex-col items-center p-2 rounded-lg ${category === key ? (theme === 'dark' ? 'bg-white/10' : 'bg-gray-100') : (theme === 'dark' ? 'bg-white/5' : 'bg-white')} border ${category === key ? 'border-primary' : (theme === 'dark' ? 'border-white/10' : 'border-gray-200')}`}
                                        onClick={() => setCategory(key)}
                                    >
                                        <div className={`w-8 h-8 rounded-full ${cat.color} flex items-center justify-center mb-1`}>
                                            <span className="material-icons text-white text-sm">{cat.icon}</span>
                                        </div>
                                        <span className={`text-xs ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                            {cat.name}
                                        </span>
                                    </motion.button>
                                ))}
                            </div>
                        </div>
                        
                        <div>
                            <label className={`block text-sm mb-1 ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'}`}>
                                Date
                            </label>
                            <input
                                type="date"
                                className={`w-full ${theme === 'dark' ? 'glass-card' : 'bg-white'} p-3 rounded-lg border ${theme === 'dark' ? 'border-white/10' : 'border-gray-200'} focus:outline-none focus:ring-2 focus:ring-primary/50`}
                                value={date}
                                onChange={(e) => setDate(e.target.value)}
                                required
                            />
                        </div>
                        
                        <div>
                            <label className={`block text-sm mb-1 ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'}`}>
                                Description (Optional)
                            </label>
                            <input
                                type="text"
                                className={`w-full ${theme === 'dark' ? 'glass-card' : 'bg-white'} p-3 rounded-lg border ${theme === 'dark' ? 'border-white/10' : 'border-gray-200'} focus:outline-none focus:ring-2 focus:ring-primary/50`}
                                value={description}
                                onChange={(e) => setDescription(e.target.value)}
                                placeholder="e.g. Dinner at Italian Restaurant"
                            />
                        </div>
                        
                        <div className="pt-2">
                            <motion.button
                                whileHover={{ scale: 1.02 }}
                                whileTap={{ scale: 0.98 }}
                                className="ripple w-full py-3 rounded-lg bg-gradient-to-r from-primary to-secondary text-white flex items-center justify-center"
                                type="submit"
                                disabled={isLoading}
                            >
                                {isLoading ? (
                                    <motion.span
                                        animate={{ rotate: 360 }}
                                        transition={{ duration: 1, repeat: Infinity, ease: "linear" }}
                                        className="w-5 h-5 border-2 border-white border-t-transparent rounded-full"
                                    />
                                ) : (
                                    'Add Expense'
                                )}
                            </motion.button>
                        </div>
                    </form>
                </Modal>
            );
        }

        // Add Investment Modal
        function AddInvestmentModal() {
            const { isAddInvestmentOpen, theme } = useAppState();
            const { toggleAddInvestment, addInvestment } = useAppActions();
            
            const [name, setName] = useState('');
            const [amount, setAmount] = useState('');
            const [type, setType] = useState('stocks');
            const [date, setDate] = useState(new Date().toISOString().split('T')[0]);
            const [roi, setRoi] = useState('0');
            const [isLoading, setIsLoading] = useState(false);
            
            const handleSubmit = (e) => {
                e.preventDefault();
                setIsLoading(true);
                
                const newInvestment = {
                    id: Date.now().toString(),
                    name,
                    amount: parseFloat(amount),
                    type,
                    date,
                    roi: parseFloat(roi)
                };
                
                setTimeout(() => {
                    addInvestment(newInvestment);
                    toggleAddInvestment();
                    setName('');
                    setAmount('');
                    setType('stocks');
                    setDate(new Date().toISOString().split('T')[0]);
                    setRoi('0');
                    setIsLoading(false);
                }, 500);
            };
            
            return (
                <Modal isOpen={isAddInvestmentOpen} onClose={toggleAddInvestment} title="Add Investment">
                    <form onSubmit={handleSubmit} className="space-y-4">
                        <div>
                            <label className={`block text-sm mb-1 ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'}`}>
                                Investment Name
                            </label>
                            <input
                                type="text"
                                className={`w-full ${theme === 'dark' ? 'glass-card' : 'bg-white'} p-3 rounded-lg border ${theme === 'dark' ? 'border-white/10' : 'border-gray-200'} focus:outline-none focus:ring-2 focus:ring-primary/50`}
                                value={name}
                                onChange={(e) => setName(e.target.value)}
                                placeholder="e.g. Tech Stocks Portfolio"
                                required
                            />
                        </div>
                        
                        <div>
                            <label className={`block text-sm mb-1 ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'}`}>
                                Amount Invested
                            </label>
                            <div className="relative">
                                <span className="material-icons absolute left-3 top-1/2 transform -translate-y-1/2 text-white/50">attach_money</span>
                                <input
                                    type="number"
                                    step="0.01"
                                    min="0.01"
                                    className={`w-full ${theme === 'dark' ? 'glass-card' : 'bg-white'} pl-10 p-3 rounded-lg border ${theme === 'dark' ? 'border-white/10' : 'border-gray-200'} focus:outline-none focus:ring-2 focus:ring-primary/50`}
                                    value={amount}
                                    onChange={(e) => setAmount(e.target.value)}
                                    required
                                />
                            </div>
                        </div>
                        
                        <div>
                            <label className={`block text-sm mb-1 ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'}`}>
                                Investment Type
                            </label>
                            <div className="grid grid-cols-2 gap-2">
                                {Object.entries(investmentTypes).map(([key, invType]) => (
                                    <motion.button
                                        key={key}
                                        whileHover={{ scale: 1.05 }}
                                        whileTap={{ scale: 0.95 }}
                                        type="button"
                                        className={`ripple flex flex-col items-center p-2 rounded-lg ${type === key ? (theme === 'dark' ? 'bg-white/10' : 'bg-gray-100') : (theme === 'dark' ? 'bg-white/5' : 'bg-white')} border ${type === key ? 'border-primary' : (theme === 'dark' ? 'border-white/10' : 'border-gray-200')}`}
                                        onClick={() => setType(key)}
                                    >
                                        <div className={`w-8 h-8 rounded-full ${invType.color} flex items-center justify-center mb-1`}>
                                            <span className="material-icons text-white text-sm">{invType.icon}</span>
                                        </div>
                                        <span className={`text-xs ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                            {invType.name}
                                        </span>
                                    </motion.button>
                                ))}
                            </div>
                        </div>
                        
                        <div>
                            <label className={`block text-sm mb-1 ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'}`}>
                                Date
                            </label>
                            <input
                                type="date"
                                className={`w-full ${theme === 'dark' ? 'glass-card' : 'bg-white'} p-3 rounded-lg border ${theme === 'dark' ? 'border-white/10' : 'border-gray-200'} focus:outline-none focus:ring-2 focus:ring-primary/50`}
                                value={date}
                                onChange={(e) => setDate(e.target.value)}
                                required
                            />
                        </div>
                        
                        <div>
                            <label className={`block text-sm mb-1 ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'}`}>
                                Return on Investment (ROI)
                            </label>
                            <div className="relative">
                                <span className="material-icons absolute left-3 top-1/2 transform -translate-y-1/2 text-white/50">percent</span>
                                <input
                                    type="number"
                                    step="0.1"
                                    className={`w-full ${theme === 'dark' ? 'glass-card' : 'bg-white'} pl-10 p-3 rounded-lg border ${theme === 'dark' ? 'border-white/10' : 'border-gray-200'} focus:outline-none focus:ring-2 focus:ring-primary/50`}
                                    value={roi}
                                    onChange={(e) => setRoi(e.target.value)}
                                    placeholder="e.g. 5.5 for 5.5%"
                                    required
                                />
                            </div>
                        </div>
                        
                        <div className="pt-2">
                            <motion.button
                                whileHover={{ scale: 1.02 }}
                                whileTap={{ scale: 0.98 }}
                                className="ripple w-full py-3 rounded-lg bg-gradient-to-r from-primary to-secondary text-white flex items-center justify-center"
                                type="submit"
                                disabled={isLoading}
                            >
                                {isLoading ? (
                                    <motion.span
                                        animate={{ rotate: 360 }}
                                        transition={{ duration: 1, repeat: Infinity, ease: "linear" }}
                                        className="w-5 h-5 border-2 border-white border-t-transparent rounded-full"
                                    />
                                ) : (
                                    'Add Investment'
                                )}
                            </motion.button>
                        </div>
                    </form>
                </Modal>
            );
        }

        // Add Budget Modal
        function AddBudgetModal() {
            const { isAddBudgetOpen, theme } = useAppState();
            const { toggleAddBudget, addBudget } = useAppActions();
            
            const [category, setCategory] = useState('food');
            const [amount, setAmount] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            
            const handleSubmit = (e) => {
                e.preventDefault();
                setIsLoading(true);
                
                const newBudget = {
                    id: Date.now().toString(),
                    category,
                    amount: parseFloat(amount),
                    spent: 0
                };
                
                setTimeout(() => {
                    addBudget(newBudget);
                    toggleAddBudget();
                    setCategory('food');
                    setAmount('');
                    setIsLoading(false);
                }, 500);
            };
            
            return (
                <Modal isOpen={isAddBudgetOpen} onClose={toggleAddBudget} title="Add Budget">
                    <form onSubmit={handleSubmit} className="space-y-4">
                        <div>
                            <label className={`block text-sm mb-1 ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'}`}>
                                Category
                            </label>
                            <div className="grid grid-cols-4 gap-2">
                                {Object.entries(categories).map(([key, cat]) => (
                                    <motion.button
                                        key={key}
                                        whileHover={{ scale: 1.05 }}
                                        whileTap={{ scale: 0.95 }}
                                        type="button"
                                        className={`ripple flex flex-col items-center p-2 rounded-lg ${category === key ? (theme === 'dark' ? 'bg-white/10' : 'bg-gray-100') : (theme === 'dark' ? 'bg-white/5' : 'bg-white')} border ${category === key ? 'border-primary' : (theme === 'dark' ? 'border-white/10' : 'border-gray-200')}`}
                                        onClick={() => setCategory(key)}
                                    >
                                        <div className={`w-8 h-8 rounded-full ${cat.color} flex items-center justify-center mb-1`}>
                                            <span className="material-icons text-white text-sm">{cat.icon}</span>
                                        </div>
                                        <span className={`text-xs ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                            {cat.name}
                                        </span>
                                    </motion.button>
                                ))}
                            </div>
                        </div>
                        
                        <div>
                            <label className={`block text-sm mb-1 ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'}`}>
                                Budget Amount
                            </label>
                            <div className="relative">
                                <span className="material-icons absolute left-3 top-1/2 transform -translate-y-1/2 text-white/50">attach_money</span>
                                <input
                                    type="number"
                                    step="0.01"
                                    min="0.01"
                                    className={`w-full ${theme === 'dark' ? 'glass-card' : 'bg-white'} pl-10 p-3 rounded-lg border ${theme === 'dark' ? 'border-white/10' : 'border-gray-200'} focus:outline-none focus:ring-2 focus:ring-primary/50`}
                                    value={amount}
                                    onChange={(e) => setAmount(e.target.value)}
                                    required
                                />
                            </div>
                        </div>
                        
                        <div className="pt-2">
                            <motion.button
                                whileHover={{ scale: 1.02 }}
                                whileTap={{ scale: 0.98 }}
                                className="ripple w-full py-3 rounded-lg bg-gradient-to-r from-primary to-secondary text-white flex items-center justify-center"
                                type="submit"
                                disabled={isLoading}
                            >
                                {isLoading ? (
                                    <motion.span
                                        animate={{ rotate: 360 }}
                                        transition={{ duration: 1, repeat: Infinity, ease: "linear" }}
                                        className="w-5 h-5 border-2 border-white border-t-transparent rounded-full"
                                    />
                                ) : (
                                    'Add Budget'
                                )}
                            </motion.button>
                        </div>
                    </form>
                </Modal>
            );
        }

        // Add Goal Modal
        function AddGoalModal() {
            const { isAddGoalOpen, theme } = useAppState();
            const { toggleAddGoal, addGoal } = useAppActions();
            
            const [name, setName] = useState('');
            const [target, setTarget] = useState('');
            const [deadline, setDeadline] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            
            const handleSubmit = (e) => {
                e.preventDefault();
                setIsLoading(true);
                
                const newGoal = {
                    id: Date.now().toString(),
                    name,
                    target: parseFloat(target),
                    saved: 0,
                    deadline
                };
                
                setTimeout(() => {
                    addGoal(newGoal);
                    toggleAddGoal();
                    setName('');
                    setTarget('');
                    setDeadline('');
                    setIsLoading(false);
                }, 500);
            };
            
            return (
                <Modal isOpen={isAddGoalOpen} onClose={toggleAddGoal} title="Add Financial Goal">
                    <form onSubmit={handleSubmit} className="space-y-4">
                        <div>
                            <label className={`block text-sm mb-1 ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'}`}>
                                Goal Name
                            </label>
                            <input
                                type="text"
                                className={`w-full ${theme === 'dark' ? 'glass-card' : 'bg-white'} p-3 rounded-lg border ${theme === 'dark' ? 'border-white/10' : 'border-gray-200'} focus:outline-none focus:ring-2 focus:ring-primary/50`}
                                value={name}
                                onChange={(e) => setName(e.target.value)}
                                placeholder="e.g. Emergency Fund, Vacation, etc."
                                required
                            />
                        </div>
                        
                        <div>
                            <label className={`block text-sm mb-1 ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'}`}>
                                Target Amount
                            </label>
                            <div className="relative">
                                <span className="material-icons absolute left-3 top-1/2 transform -translate-y-1/2 text-white/50">attach_money</span>
                                <input
                                    type="number"
                                    step="0.01"
                                    min="0.01"
                                    className={`w-full ${theme === 'dark' ? 'glass-card' : 'bg-white'} pl-10 p-3 rounded-lg border ${theme === 'dark' ? 'border-white/10' : 'border-gray-200'} focus:outline-none focus:ring-2 focus:ring-primary/50`}
                                    value={target}
                                    onChange={(e) => setTarget(e.target.value)}
                                    required
                                />
                            </div>
                        </div>
                        
                        <div>
                            <label className={`block text-sm mb-1 ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'}`}>
                                Deadline
                            </label>
                            <input
                                type="date"
                                className={`w-full ${theme === 'dark' ? 'glass-card' : 'bg-white'} p-3 rounded-lg border ${theme === 'dark' ? 'border-white/10' : 'border-gray-200'} focus:outline-none focus:ring-2 focus:ring-primary/50`}
                                value={deadline}
                                onChange={(e) => setDeadline(e.target.value)}
                                required
                                min={new Date().toISOString().split('T')[0]}
                            />
                        </div>
                        
                        <div className="pt-2">
                            <motion.button
                                whileHover={{ scale: 1.02 }}
                                whileTap={{ scale: 0.98 }}
                                className="ripple w-full py-3 rounded-lg bg-gradient-to-r from-primary to-secondary text-white flex items-center justify-center"
                                type="submit"
                                disabled={isLoading}
                            >
                                {isLoading ? (
                                    <motion.span
                                        animate={{ rotate: 360 }}
                                        transition={{ duration: 1, repeat: Infinity, ease: "linear" }}
                                        className="w-5 h-5 border-2 border-white border-t-transparent rounded-full"
                                    />
                                ) : (
                                    'Add Goal'
                                )}
                            </motion.button>
                        </div>
                    </form>
                </Modal>
            );
        }

        // Settings Modal
        function SettingsModal() {
            const { isSettingsOpen, user, theme } = useAppState();
            const { toggleSettings, toggleTheme, updateUser, logout } = useAppActions();
            
            const [name, setName] = useState(user?.name || '');
            const [email, setEmail] = useState(user?.email || '');
            const [currency, setCurrency] = useState(user?.currency || 'USD');
            const [isLoading, setIsLoading] = useState(false);
            
            useEffect(() => {
                if (user) {
                    setName(user.name);
                    setEmail(user.email);
                    setCurrency(user.currency);
                }
            }, [user]);
            
            const handleSubmit = (e) => {
                e.preventDefault();
                setIsLoading(true);
                
                const updatedUser = {
                    ...user,
                    name,
                    email,
                    currency
                };
                
                setTimeout(() => {
                    updateUser(updatedUser);
                    setIsLoading(false);
                }, 500);
            };
            
            return (
                <Modal isOpen={isSettingsOpen} onClose={toggleSettings} title="Settings" wide>
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div className="md:col-span-2">
                            <form onSubmit={handleSubmit} className="space-y-4">
                                <div>
                                    <label className={`block text-sm mb-1 ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'}`}>
                                        Full Name
                                    </label>
                                    <input
                                        type="text"
                                        className={`w-full ${theme === 'dark' ? 'glass-card' : 'bg-white'} p-3 rounded-lg border ${theme === 'dark' ? 'border-white/10' : 'border-gray-200'} focus:outline-none focus:ring-2 focus:ring-primary/50`}
                                        value={name}
                                        onChange={(e) => setName(e.target.value)}
                                        required
                                    />
                                </div>
                                
                                <div>
                                    <label className={`block text-sm mb-1 ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'}`}>
                                        Email
                                    </label>
                                    <input
                                        type="email"
                                        className={`w-full ${theme === 'dark' ? 'glass-card' : 'bg-white'} p-3 rounded-lg border ${theme === 'dark' ? 'border-white/10' : 'border-gray-200'} focus:outline-none focus:ring-2 focus:ring-primary/50`}
                                        value={email}
                                        onChange={(e) => setEmail(e.target.value)}
                                        required
                                    />
                                </div>
                                
                                <div>
                                    <label className={`block text-sm mb-1 ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'}`}>
                                        Currency
                                    </label>
                                    <select
                                        className={`w-full ${theme === 'dark' ? 'glass-card' : 'bg-white'} p-3 rounded-lg border ${theme === 'dark' ? 'border-white/10' : 'border-gray-200'} focus:outline-none focus:ring-2 focus:ring-primary/50`}
                                        value={currency}
                                        onChange={(e) => setCurrency(e.target.value)}
                                        required
                                    >
										<option value="INR">Indian Rupee (₹)</option>
                                        <option value="USD">US Dollar (USD)</option>
                                        <option value="EUR">Euro (EUR)</option>
                                        <option value="GBP">British Pound (GBP)</option>
                                        <option value="JPY">Japanese Yen (JPY)</option>
                                        <option value="CAD">Canadian Dollar (CAD)</option>
                                        <option value="AUD">Australian Dollar (AUD)</option>
                                    </select>
                                </div>
                                
                                <div className="pt-2">
                                    <motion.button
                                        whileHover={{ scale: 1.02 }}
                                        whileTap={{ scale: 0.98 }}
                                        className="ripple w-full py-3 rounded-lg bg-gradient-to-r from-primary to-secondary text-white flex items-center justify-center"
                                        type="submit"
                                        disabled={isLoading}
                                    >
                                        {isLoading ? (
                                            <motion.span
                                                animate={{ rotate: 360 }}
                                                transition={{ duration: 1, repeat: Infinity, ease: "linear" }}
                                                className="w-5 h-5 border-2 border-white border-t-transparent rounded-full"
                                            />
                                        ) : (
                                            'Save Changes'
                                        )}
                                    </motion.button>
                                </div>
                            </form>
                        </div>
                        
                        <div className="space-y-4">
                            <div className={`p-4 rounded-lg ${theme === 'dark' ? 'glass-card' : 'bg-white shadow-sm'}`}>
                                <h4 className={`font-medium mb-3 ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                    Appearance
                                </h4>
                                <div className="flex items-center justify-between">
                                    <span className={`text-sm ${theme === 'dark' ? 'text-white/70' : 'text-gray-600'}`}>
                                        Dark Mode
                                    </span>
                                    <button
                                        className="ripple p-1 rounded-full bg-gradient-to-r from-primary to-secondary"
                                        onClick={toggleTheme}
                                        aria-label="Toggle theme"
                                    >
                                        <span className="material-icons text-white text-sm">
                                            {theme === 'dark' ? 'dark_mode' : 'light_mode'}
                                        </span>
                                    </button>
                                </div>
                            </div>
                            
                            <div className={`p-4 rounded-lg ${theme === 'dark' ? 'glass-card' : 'bg-white shadow-sm'}`}>
                                <h4 className={`font-medium mb-3 ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                    Account
                                </h4>
                                <div className="space-y-3">
                                    <button
                                        className={`w-full text-left px-3 py-2 rounded-lg ${theme === 'dark' ? 'hover:bg-white/5' : 'hover:bg-gray-50'} transition flex items-center`}
                                        onClick={() => {}}
                                    >
                                        <span className="material-icons mr-2 text-sm">lock</span>
                                        <span className={`text-sm ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                            Change Password
                                        </span>
                                    </button>
                                    <button
                                        className={`w-full text-left px-3 py-2 rounded-lg ${theme === 'dark' ? 'hover:bg-white/5' : 'hover:bg-gray-50'} transition flex items-center`}
                                        onClick={() => {}}
                                    >
                                        <span className="material-icons mr-2 text-sm">file_download</span>
                                        <span className={`text-sm ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                            Export Data
                                        </span>
                                    </button>
                                    <button
                                        className={`w-full text-left px-3 py-2 rounded-lg ${theme === 'dark' ? 'hover:bg-white/5' : 'hover:bg-gray-50'} transition flex items-center text-red-400`}
                                        onClick={logout}
                                    >
                                        <span className="material-icons mr-2 text-sm">logout</span>
                                        <span className="text-sm">
                                            Logout
                                        </span>
                                    </button>
                                </div>
                            </div>
                            
                            <div className={`p-4 rounded-lg ${theme === 'dark' ? 'glass-card' : 'bg-white shadow-sm'}`}>
                                <h4 className={`font-medium mb-3 ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                    About
                                </h4>
                                <div className="space-y-2">
                                    <p className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-600'}`}>
                                        Fintrak v1.0.0
                                    </p>
                                    <p className={`text-xs ${theme === 'dark' ? 'text-white/50' : 'text-gray-600'}`}>
                                        © {new Date().getFullYear()} Fintrak. All rights reserved.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </Modal>
            );
        }

        // Modal Component
        function Modal({ isOpen, onClose, title, children, wide = false }) {
            const { theme } = useAppState();
            
            return (
                <AnimatePresence>
                    {isOpen && (
                        <motion.div
                            initial={{ opacity: 0 }}
                            animate={{ opacity: 1 }}
                            exit={{ opacity: 0 }}
                            className="fixed inset-0 z-50 flex items-center justify-center p-4"
                        >
                            <motion.div
                                initial={{ opacity: 0, scale: 0.9 }}
                                animate={{ opacity: 1, scale: 1 }}
                                exit={{ opacity: 0, scale: 0.9 }}
                                className={`relative ${wide ? 'max-w-4xl' : 'max-w-md'} w-full ${theme === 'dark' ? 'glass-card' : 'bg-white shadow-xl'} rounded-2xl overflow-hidden`}
                            >
                                <div className={`flex justify-between items-center p-5 border-b ${theme === 'dark' ? 'border-white/10' : 'border-gray-200'}`}>
                                    <h3 className={`text-lg font-medium ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                        {title}
                                    </h3>
                                    <button
                                        className="ripple p-1 rounded-full hover:bg-white/10"
                                        onClick={onClose}
                                        aria-label="Close modal"
                                    >
                                        <span className="material-icons text-white/50 hover:text-white">close</span>
                                    </button>
                                </div>
                                
                                <div className="p-5">
                                    {children}
                                </div>
                            </motion.div>
                            
                            <div 
                                className="absolute inset-0 bg-black/50 backdrop-blur-sm -z-10" 
                                onClick={onClose}
                            />
                        </motion.div>
                    )}
                </AnimatePresence>
            );
        }

        // Notifications Component
        function Notifications() {
            const { notifications, theme } = useAppState();
            const { removeNotification } = useAppActions();
            
            return (
                <div className="fixed bottom-4 right-4 z-50 space-y-2">
                    <AnimatePresence>
                        {notifications.map(notification => (
                            <motion.div
                                key={notification.id}
                                initial={{ opacity: 0, y: 20 }}
                                animate={{ opacity: 1, y: 0 }}
                                exit={{ opacity: 0, x: 20 }}
                                transition={{ duration: 0.3 }}
                                className={`${theme === 'dark' ? 'glass-card' : 'bg-white shadow-lg'} rounded-lg overflow-hidden`}
                            >
                                <div className="flex items-start p-3">
                                    <div className={`mr-3 p-2 rounded-full ${theme === 'dark' ? 'bg-white/10' : 'bg-gray-100'}`}>
                                        <span className="material-icons">
                                            {notification.icon || 'notifications'}
                                        </span>
                                    </div>
                                    <div className="flex-1">
                                        <h4 className={`text-sm font-medium ${theme === 'dark' ? 'text-white' : 'text-gray-800'}`}>
                                            {notification.message}
                                        </h4>
                                        {notification.action && (
                                            <p className={`text-xs mt-1 ${theme === 'dark' ? 'text-white/50' : 'text-gray-600'}`}>
                                                {notification.action}
                                            </p>
                                        )}
                                    </div>
                                    <button
                                        className="ripple p-1 rounded-full hover:bg-white/10 ml-2"
                                        onClick={() => removeNotification(notification.id)}
                                        aria-label="Dismiss notification"
                                    >
                                        <span className="material-icons text-sm">close</span>
                                    </button>
                                </div>
                                <motion.div
                                    initial={{ width: '100%' }}
                                    animate={{ width: '0%' }}
                                    transition={{ duration: 5, ease: "linear" }}
                                    className="h-1 bg-primary"
                                />
                            </motion.div>
                        ))}
                    </AnimatePresence>
                </div>
            );
        }

        // Render the app
        ReactDOM.render(
            <AppProvider>
                <App />
            </AppProvider>,
            document.getElementById('root')
        );
    </script>
</body>
</html>